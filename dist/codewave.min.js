!function(){return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){return i(t[s][1][e]||e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}}()({1:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.BoxHelper=void 0;var i=e("./helpers/StringHelper"),o=(e("./helpers/ArrayHelper"),e("./positioning/Pair")),s=function(){function e(t){var n,r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t,this.defaults={deco:this.context.codewave.deco,pad:2,width:50,height:3,openText:"",closeText:"",prefix:"",suffix:"",indent:0},r=this.defaults)i=r[n],this[n]=n in o?o[n]:i}var t,n,s;return t=e,(n=[{key:"clone",value:function(t){var n,r,i;for(n in r={},i=this.defaults)i[n],r[n]=this[n];return new e(this.context,r)}},{key:"draw",value:function(e){return this.startSep()+"\n"+this.lines(e)+"\n"+this.endSep()}},{key:"wrapComment",value:function(e){return this.context.wrapComment(e)}},{key:"separator",value:function(){var e;return e=this.width+2*this.pad+2*this.deco.length,this.wrapComment(this.decoLine(e))}},{key:"startSep",value:function(){var e;return e=this.width+2*this.pad+2*this.deco.length-this.openText.length,this.prefix+this.wrapComment(this.openText+this.decoLine(e))}},{key:"endSep",value:function(){var e;return e=this.width+2*this.pad+2*this.deco.length-this.closeText.length,this.wrapComment(this.closeText+this.decoLine(e))+this.suffix}},{key:"decoLine",value:function(e){return i.StringHelper.repeatToLength(this.deco,e)}},{key:"padding",value:function(){return i.StringHelper.repeatToLength(" ",this.pad)}},{key:"lines",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=(r=r||"").replace(/\r/g,"").split("\n"),i?function(){var e,r,i;for(i=[],n=e=0,r=this.height;0<=r?e<=r:e>=r;n=0<=r?++e:--e)i.push(this.line(t[n]||""));return i}.call(this).join("\n"):function(){var n,r,i;for(i=[],n=0,r=t.length;n<r;n++)e=t[n],i.push(this.line(e));return i}.call(this).join("\n")}},{key:"line",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.StringHelper.repeatToLength(" ",this.indent)+this.wrapComment(this.deco+this.padding()+e+i.StringHelper.repeatToLength(" ",this.width-this.removeIgnoredContent(e).length)+this.padding()+this.deco)}},{key:"left",value:function(){return this.context.wrapCommentLeft(this.deco+this.padding())}},{key:"right",value:function(){return this.context.wrapCommentRight(this.padding()+this.deco)}},{key:"removeIgnoredContent",value:function(e){return this.context.codewave.removeMarkers(this.context.codewave.removeCarret(e))}},{key:"textBounds",value:function(e){return i.StringHelper.getTxtSize(this.removeIgnoredContent(e))}},{key:"getBoxForPos",value:function(e){var t,n,r,s,a,l,u,c=this;if((r=this.getNestedLvl(e.start))>0&&(a=this.left(),n=i.StringHelper.repeat(a,r-1),"###PlaceHolder###",(t=this.clone()).width="###PlaceHolder###".length,t.openText=t.closeText=this.deco+this.deco+"###PlaceHolder###"+this.deco+this.deco,u=RegExp(i.StringHelper.escapeRegExp(n+t.startSep()).replace("###PlaceHolder###",".*")),s=RegExp(i.StringHelper.escapeRegExp(n+t.endSep()).replace("###PlaceHolder###",".*")),null!=(l=new o.Pair(u,s,{validMatch:function(e){var t;return null==(t=c.context.codewave.findAnyNext(e.start(),[a,"\n","\r"],-1))||t.str!==a}}).wrapperPos(e,this.context.codewave.editor.text()))))return l.start+=n.length,l}},{key:"getNestedLvl",value:function(e){var t,n,r;for(t=0,r=this.left();null!=(n=this.context.codewave.findAnyNext(e,[r,"\n","\r"],-1))&&n.str===r;)e=n.pos,t++;return t}},{key:"getOptFromLine",value:function(e){var t,n,r,o,s,a,l=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return r=new RegExp("(\\s*)("+i.StringHelper.escapeRegExp(this.context.wrapCommentLeft(this.deco))+")(\\s*)"),n=new RegExp("(\\s*)("+i.StringHelper.escapeRegExp(this.context.wrapCommentRight(this.deco))+")(\n|$)"),s=r.exec(e),o=n.exec(e),null!=s&&null!=o&&(l&&(this.pad=Math.min(s[3].length,o[1].length)),this.indent=s[1].length,a=s.index+s[1].length+s[2].length+this.pad,t=o.index+o[1].length-this.pad,this.width=t-a),this}},{key:"reformatLines",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.lines(this.removeComment(e,t),!1)}},{key:"removeComment",value:function(e){var t,n,r,o,s,a,l,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=e)return t={multiline:!0},Object.assign({},t,u),n=i.StringHelper.escapeRegExp(this.context.wrapCommentLeft()),r=i.StringHelper.escapeRegExp(this.context.wrapCommentRight()),o=i.StringHelper.escapeRegExp(this.deco),s=u.multiline?"gm":"",a=new RegExp("^\\s*".concat(n,"(?:").concat(o,")*\\s{0,").concat(this.pad,"}"),s),l=new RegExp("\\s*(?:".concat(o,")*").concat(r,"\\s*$"),s),e.replace(a,"").replace(l,"")}}])&&r(t.prototype,n),s&&r(t,s),e}();n.BoxHelper=s},{"./helpers/ArrayHelper":24,"./helpers/StringHelper":28,"./positioning/Pair":29}],2:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.SimulatedClosingPromp=n.ClosingPromp=void 0;var c=e("./positioning/PosCollection"),h=e("./positioning/Replacement"),f=e("./positioning/Pos"),d=e("./helpers/OptionalPromise"),p=function(){function e(t,n){a(this,e),this.codewave=t,this.timeout=null,this._typed=null,this.started=!1,this.nbChanges=0,this.selections=new c.PosCollection(n)}return u(e,[{key:"begin",value:function(){var e=this;return this.started=!0,(0,d.optionalPromise)(this.addCarrets()).then(function(){return e.codewave.editor.canListenToChange()&&(e.proxyOnChange=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e.onChange(t)},e.codewave.editor.addChangeListener(e.proxyOnChange)),e}).result()}},{key:"addCarrets",value:function(){return this.replacements=this.selections.wrap(this.codewave.brakets+this.codewave.carretChar+this.codewave.brakets+"\n","\n"+this.codewave.brakets+this.codewave.closeChar+this.codewave.carretChar+this.codewave.brakets).map(function(e){return e.carretToSel()}),this.codewave.editor.applyReplacements(this.replacements)}},{key:"invalidTyped",value:function(){return this._typed=null}},{key:"onChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.invalidTyped(),!this.skipEvent(e))return this.nbChanges++,this.shouldStop()?(this.stop(),this.cleanClose()):this.resume()}},{key:"skipEvent",value:function(e){return null!=e&&32!==e.charCodeAt(0)}},{key:"resume",value:function(){}},{key:"shouldStop",value:function(){return!1===this.typed()||-1!==this.typed().indexOf(" ")}},{key:"cleanClose",value:function(){var e,t,n,r,i,o,s,a,l;for(i=[],t=0,n=(a=this.getSelections()).length;t<n;t++)s=a[t],this.whithinOpenBounds(s)?l=s:(e=this.whithinCloseBounds(s))&&null!=l&&(o=e.withEditor(this.codewave.editor).innerText().split(" ")[0],(r=new h.Replacement(e.innerStart,e.innerEnd,o)).selections=[l],i.push(r),l=null);return this.codewave.editor.applyReplacements(i)}},{key:"getSelections",value:function(){return this.codewave.editor.getMultiSel()}},{key:"stop",value:function(){if(this.started=!1,null!=this.timeout&&clearTimeout(this.timeout),this.codewave.closingPromp===this&&(this.codewave.closingPromp=null),null!=this.proxyOnChange)return this.codewave.editor.removeChangeListener(this.proxyOnChange)}},{key:"cancel",value:function(){return!1!==this.typed()&&this.cancelSelections(this.getSelections()),this.stop()}},{key:"cancelSelections",value:function(e){var t,n,r,i,o,s,a;for(o=[],a=null,n=0,r=e.length;n<r;n++)s=e[n],(i=this.whithinOpenBounds(s))?a=i:(t=this.whithinCloseBounds(s))&&null!=a&&(o.push(new h.Replacement(a.start,t.end,this.codewave.editor.textSubstr(a.end+1,t.start-1)).selectContent()),a=null);return this.codewave.editor.applyReplacements(o)}},{key:"typed",value:function(){var e,t,n;return null==this._typed&&(e=this.codewave.editor.getCursorPos(),n=this.replacements[0].start+this.codewave.brakets.length,this.codewave.findPrevBraket(e.start)===this.replacements[0].start&&null!=(t=this.codewave.findNextBraket(n))&&t>=e.end?this._typed=this.codewave.editor.textSubstr(n,t):this._typed=!1),this._typed}},{key:"whithinOpenBounds",value:function(e){var t,n,r,i,o,s;for(t=n=0,r=(i=this.replacements).length;n<r;t=++n)if(i[t],o=this.startPosAt(t),s=this.codewave.brakets+this.typed()+this.codewave.brakets,o.innerContainsPos(e)&&o.withEditor(this.codewave.editor).text()===s)return o;return!1}},{key:"whithinCloseBounds",value:function(e){var t,n,r,i,o,s;for(t=n=0,r=(i=this.replacements).length;n<r;t=++n)if(i[t],o=this.endPosAt(t),s=this.codewave.brakets+this.codewave.closeChar+this.typed()+this.codewave.brakets,o.innerContainsPos(e)&&o.withEditor(this.codewave.editor).text()===s)return o;return!1}},{key:"startPosAt",value:function(e){return new f.Pos(this.replacements[e].selections[0].start+this.typed().length*(2*e),this.replacements[e].selections[0].end+this.typed().length*(2*e+1)).wrappedBy(this.codewave.brakets,this.codewave.brakets)}},{key:"endPosAt",value:function(e){return new f.Pos(this.replacements[e].selections[1].start+this.typed().length*(2*e+1),this.replacements[e].selections[1].end+this.typed().length*(2*e+2)).wrappedBy(this.codewave.brakets+this.codewave.closeChar,this.codewave.brakets)}}]),e}();n.ClosingPromp=p;var m=function(e){function t(){return a(this,t),i(this,o(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,p),u(t,[{key:"resume",value:function(){return this.simulateType()}},{key:"simulateType",value:function(){var e=this;return null!=this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){var t,n,r;if(e.invalidTyped(),r=e.codewave.brakets+e.codewave.closeChar+e.typed()+e.codewave.brakets,(t=e.whithinCloseBounds(e.replacements[0].selections[1].copy().applyOffset(e.typed().length)))?(n=new h.Replacement(t.start,t.end,r)).withEditor(e.codewave.editor).necessary()&&e.codewave.editor.applyReplacements([n]):e.stop(),null!=e.onTypeSimulated)return e.onTypeSimulated()},2)}},{key:"skipEvent",value:function(){return!1}},{key:"getSelections",value:function(){return[this.codewave.editor.getCursorPos(),this.replacements[0].selections[1]+this.typed().length]}},{key:"whithinCloseBounds",value:function(e){var t,n,r,i,o,s;for(t=n=0,r=(o=this.replacements).length;n<r;t=++n)if(o[t],s=this.endPosAt(t),null!=(i=this.codewave.findNextBraket(s.innerStart))&&(s.moveSuffix(i),s.innerContainsPos(e)))return s;return!1}}]),t}();n.SimulatedClosingPromp=m,p.newFor=function(e,t){return e.editor.allowMultiSelection()?new p(e,t):new m(e,t)}},{"./helpers/OptionalPromise":27,"./positioning/Pos":31,"./positioning/PosCollection":32,"./positioning/Replacement":33}],3:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.CmdFinder=void 0;var o=e("./Context"),s=e("./helpers/NamespaceHelper"),a=e("./Command"),l=[].indexOf,u=function(){function e(t,n){var r,i,s;for(i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t&&(t=[t]),r={parent:null,namespaces:[],parentContext:null,context:null,root:a.Command.cmds,mustExecute:!0,useDetectors:!0,useFallbacks:!0,instance:null,codewave:null},this.names=t,this.parent=n.parent,r)s=r[i],i in n?this[i]=n[i]:null!=this.parent&&"parent"!==i?this[i]=this.parent[i]:this[i]=s;null==this.context&&(this.context=new o.Context(this.codewave)),null!=this.parentContext&&(this.context.parent=this.parentContext),null!=this.namespaces&&this.context.addNamespaces(this.namespaces)}var t,n,u;return t=e,(n=[{key:"find",value:function(){return this.triggerDetectors(),this.cmd=this.findIn(this.root),this.cmd}},{key:"getNamesWithPaths",value:function(){var e,t,n,i,o,a,u;for(i={},e=0,t=(o=this.names).length;e<t;e++){n=o[e];var c=r(s.NamespaceHelper.splitFirst(n),2);u=c[0],a=c[1],null==u||l.call(this.context.getNameSpaces(),u)>=0||(u in i||(i[u]=[]),i[u].push(a))}return i}},{key:"applySpaceOnNames",value:function(e){var t,n,i=r(s.NamespaceHelper.splitFirst(e,!0),2);return n=i[0],t=i[1],this.names.map(function(e){var i,o,a=r(s.NamespaceHelper.splitFirst(e),2);return o=a[0],i=a[1],null!=o&&o===n&&(e=i),null!=t&&(e=t+":"+e),e})}},{key:"getDirectNames",value:function(){var e;return function(){var t,n,r,i;for(i=[],t=0,n=(r=this.names).length;t<n;t++)-1===(e=r[t]).indexOf(":")&&i.push(e);return i}.call(this)}},{key:"triggerDetectors",value:function(){var t,n,r,i,o,s,a;if(this.useDetectors){for(this.useDetectors=!1,i=new e(this.context.getNameSpaces(),{parent:this,mustExecute:!1,useFallbacks:!1}).findPosibilities(),t=0,a=[];t<i.length;){for(n=0,r=(o=i[t].detectors).length;n<r;n++)null!=(s=o[n].detect(this))&&(this.context.addNamespaces(s),i=i.concat(new e(s,{parent:this,mustExecute:!1,useFallbacks:!1}).findPosibilities()));a.push(t++)}return a}}},{key:"findIn",value:function(e){var t;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null==e?null:null!=(t=this.bestInPosibilities(this.findPosibilities()))?t:void 0}},{key:"findPosibilities",value:function(){var t,n,i,o,a,l,u,c,h,f,d,p,m,v,y,g,b,w,k,x,C;if(null==this.root)return[];for(C in this.root.init(),b=[],w=this.getNamesWithPaths())for(p=w[C],i=0,l=(v=this.getCmdFollowAlias(C)).length;i<l;i++)m=v[i],b=b.concat(new e(p,{parent:this,root:m}).findPosibilities());for(o=0,u=(k=this.context.getNameSpaces()).length;o<u;o++){y=k[o];var P=r(s.NamespaceHelper.splitFirst(y,!0),2);for(g=P[0],P[1],a=0,c=(v=this.getCmdFollowAlias(g)).length;a<c;a++)m=v[a],b=b.concat(new e(this.applySpaceOnNames(y),{parent:this,root:m}).findPosibilities())}for(f=0,h=(x=this.getDirectNames()).length;f<h;f++)d=x[f],t=this.root.getCmd(d),this.cmdIsValid(t)&&b.push(t);return this.useFallbacks&&(n=this.root.getCmd("fallback"),this.cmdIsValid(n)&&b.push(n)),this.posibilities=b,b}},{key:"getCmdFollowAlias",value:function(e){var t;return null!=(t=this.root.getCmd(e))?(t.init(),null!=t.aliasOf?[t,t.getAliased()]:[t]):[t]}},{key:"cmdIsValid",value:function(e){return null!=e&&(!("fallback"!==e.name&&l.call(this.ancestors(),e)>=0)&&(!this.mustExecute||this.cmdIsExecutable(e)))}},{key:"ancestors",value:function(){var e;return null!=(null!=(e=this.codewave)?e.inInstance:void 0)?this.codewave.inInstance.ancestorCmdsAndSelf():[]}},{key:"cmdIsExecutable",value:function(e){var t;return 1===(t=this.getDirectNames()).length?e.init().isExecutableWithName(t[0]):e.init().isExecutable()}},{key:"cmdScore",value:function(e){var t;return t=e.depth,"fallback"===e.name&&(t-=1e3),t}},{key:"bestInPosibilities",value:function(e){var t,n,r,i,o,s;if(e.length>0){for(t=null,n=null,r=0,i=e.length;r<i;r++)o=e[r],s=this.cmdScore(o),(null==t||s>=n)&&(n=s,t=o);return t}}}])&&i(t.prototype,n),u&&i(t,u),e}();n.CmdFinder=u},{"./Command":6,"./Context":7,"./helpers/NamespaceHelper":26}],4:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.CmdInstance=void 0;var o=e("./Context"),s=e("./Codewave"),a=e("./TextParser"),l=e("./helpers/StringHelper"),u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cmd=t,this.context=n}var t,n,u;return t=e,(n=[{key:"init",value:function(){return this.isEmpty()||this.inited||(this.inited=!0,this._getCmdObj(),this._initParams(),null!=this.cmdObj&&this.cmdObj.init()),this}},{key:"setParam",value:function(e,t){return this.named[e]=t}},{key:"pushParam",value:function(e){return this.params.push(e)}},{key:"getContext",value:function(){return null==this.context&&(this.context=new o.Context),this.context||new o.Context}},{key:"getFinder",value:function(e){var t;return(t=this.getContext().getFinder(e,this._getParentNamespaces())).instance=this,t}},{key:"_getCmdObj",value:function(){var e;if(null!=this.cmd&&(this.cmd.init(),(e=this.getAliased()||this.cmd).init(),null!=e.cls))return this.cmdObj=new e.cls(this),this.cmdObj}},{key:"_initParams",value:function(){return this.named=this.getDefaults()}},{key:"_getParentNamespaces",value:function(){return[]}},{key:"isEmpty",value:function(){return null!=this.cmd}},{key:"resultIsAvailable",value:function(){var e;return null!=this.cmd&&(null!=this.cmdObj?this.cmdObj.resultIsAvailable():null!=(e=this.getAliasedFinal())?e.resultIsAvailable():this.cmd.resultIsAvailable())}},{key:"getDefaults",value:function(){var e,t;if(null!=this.cmd)return t={},null!=(e=this.getAliased())&&(t=Object.assign(t,e.getDefaults())),t=Object.assign(t,this.cmd.defaults),null!=this.cmdObj&&(t=Object.assign(t,this.cmdObj.getDefaults())),t}},{key:"getAliased",value:function(){if(null!=this.cmd)return null==this.aliasedCmd&&this.getAliasedFinal(),this.aliasedCmd||null}},{key:"getAliasedFinal",value:function(){var e;if(null!=this.cmd){if(null!=this.aliasedFinalCmd)return this.aliasedFinalCmd||null;if(null!=this.cmd.aliasOf){for(e=this.cmd;null!=e&&null!=e.aliasOf;)e=e._aliasedFromFinder(this.getFinder(this.alterAliasOf(e.aliasOf))),null==this.aliasedCmd&&(this.aliasedCmd=e||!1);return this.aliasedFinalCmd=e||!1,e}}}},{key:"alterAliasOf",value:function(e){return e}},{key:"getOptions",value:function(){var e;if(null!=this.cmd)return null!=this.cmdOptions?this.cmdOptions:(e=this.cmd._optionsForAliased(this.getAliased()),null!=this.cmdObj&&(e=Object.assign(e,this.cmdObj.getOptions())),this.cmdOptions=e,e)}},{key:"getOption",value:function(e){var t;if(null!=(t=this.getOptions())&&e in t)return t[e]}},{key:"getParam",value:function(e){var t,n,i,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for("string"!==(o=r(e))&&"number"!==o||(e=[e]),t=0,n=e.length;t<n;t++){if(i=e[t],null!=this.named[i])return this.named[i];if(null!=this.params[i])return this.params[i]}return s}},{key:"ancestorCmds",value:function(){var e;return null!=(null!=(e=this.context.codewave)?e.inInstance:void 0)?this.context.codewave.inInstance.ancestorCmdsAndSelf():[]}},{key:"ancestorCmdsAndSelf",value:function(){return this.ancestorCmds().concat([this.cmd])}},{key:"runExecuteFunct",value:function(){var e;if(null!=this.cmd){if(null!=this.cmdObj)return this.cmdObj.execute();if((e=this.getAliasedFinal()||this.cmd).init(),null!=e.executeFunct)return e.executeFunct(this)}}},{key:"rawResult",value:function(){var e;if(null!=this.cmd){if(null!=this.cmdObj)return this.cmdObj.result();if((e=this.getAliasedFinal()||this.cmd).init(),null!=e.resultFunct)return e.resultFunct(this);if(null!=e.resultStr)return e.resultStr}}},{key:"result",value:function(){var e,t;if(this.init(),this.resultIsAvailable()&&null!=(t=this.rawResult()))return(t=this.formatIndent(t)).length>0&&this.getOption("parse",this)&&(t=this.getParserForText(t).parseAll()),(e=this.getOption("alterResult",this))&&(t=e(t,this)),t}},{key:"getParserForText",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e=new s.Codewave(new a.TextParser(t),{inInstance:this})).checkCarret=!1,e}},{key:"getIndent",value:function(){return 0}},{key:"formatIndent",value:function(e){return null!=e?e.replace(/\t/g,"  "):e}},{key:"applyIndent",value:function(e){return l.StringHelper.indentNotFirst(e,this.getIndent()," ")}}])&&i(t.prototype,n),u&&i(t,u),e}();n.CmdInstance=u},{"./Codewave":5,"./Context":7,"./TextParser":17,"./helpers/StringHelper":28}],5:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Codewave=void 0;var i=e("./Process"),o=e("./Context"),s=e("./PositionedCmdInstance"),a=e("./TextParser"),l=e("./Command"),u=e("./Logger"),c=e("./positioning/PosCollection"),h=e("./helpers/StringHelper"),f=e("./ClosingPromp"),d=function(){var e=function(){function e(t){var n,r,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,e.init(),this.marker="[[[[codewave_marquer]]]]",this.vars={},n={brakets:"~~",deco:"~",closeChar:"/",noExecuteChar:"!",carretChar:"|",checkCarret:!0,inInstance:null},this.parent=s.parent,this.nested=null!=this.parent?this.parent.nested+1:0,n)i=n[r],r in s?this[r]=s[r]:null!=this.parent&&"parent"!==r?this[r]=this.parent[r]:this[r]=i;null!=this.editor&&this.editor.bindedTo(this),this.context=new o.Context(this),null!=this.inInstance&&(this.context.parent=this.inInstance.context),this.logger=new u.Logger}var t,n,d;return t=e,d=[{key:"init",value:function(){if(!this.inited)return this.inited=!0,l.Command.initCmds(),l.Command.loadCmds()}}],(n=[{key:"onActivationKey",value:function(){var e=this;return this.process=new i.Process,this.logger.log("activation key"),this.runAtCursorPos().then(function(){return e.process=null})}},{key:"runAtCursorPos",value:function(){return this.editor.allowMultiSelection()?this.runAtMultiPos(this.editor.getMultiSel()):this.runAtPos(this.editor.getCursorPos())}},{key:"runAtPos",value:function(e){return this.runAtMultiPos([e])}},{key:"runAtMultiPos",value:function(e){var t=this;return Promise.resolve().then(function(){var n;if(e.length>0)return null!=(n=t.commandOnPos(e[0].end))?(e.length>1&&n.setMultiPos(e),n.init(),t.logger.log(n),n.execute()):e[0].start===e[0].end?t.addBrakets(e):t.promptClosingCmd(e)})}},{key:"commandOnPos",value:function(e){var t,n;if(this.precededByBrakets(e)&&this.followedByBrakets(e)&&this.countPrevBraket(e)%2==1)n=e-this.brakets.length,t=e;else{if(this.precededByBrakets(e)&&this.countPrevBraket(e)%2==0&&(e-=this.brakets.length),null==(n=this.findPrevBraket(e)))return null;if(null==(t=this.findNextBraket(e-1))||this.countPrevBraket(n)%2!=0)return null}return new s.PositionedCmdInstance(this,n,this.editor.textSubstr(n,t+this.brakets.length))}},{key:"nextCmd",value:function(){var e,t,n;for(n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t=this.findAnyNext(n,[this.brakets,"\n"]);)if(n=t.pos+t.str.length,t.str===this.brakets){if(null!=e)return new s.PositionedCmdInstance(this,e,this.editor.textSubstr(e,t.pos+this.brakets.length));e=t.pos}else e=null;return null}},{key:"getEnclosingCmd",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;for(n=i,e=this.brakets+this.closeChar;null!=(r=this.findNext(n,e));)if(t=this.commandOnPos(r+e.length)){if(n=t.getEndPos(),t.pos<i)return t}else n=r+e.length;return null}},{key:"precededByBrakets",value:function(e){return this.editor.textSubstr(e-this.brakets.length,e)===this.brakets}},{key:"followedByBrakets",value:function(e){return this.editor.textSubstr(e,e+this.brakets.length)===this.brakets}},{key:"countPrevBraket",value:function(e){var t;for(t=0;null!=(e=this.findPrevBraket(e));)t++;return t}},{key:"isEndLine",value:function(e){return"\n"===this.editor.textSubstr(e,e+1)||e+1>=this.editor.textLen()}},{key:"findPrevBraket",value:function(e){return this.findNextBraket(e,-1)}},{key:"findNextBraket",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((t=this.findAnyNext(e,[this.brakets,"\n"],n))&&t.str===this.brakets)return t.pos}},{key:"findPrev",value:function(e,t){return this.findNext(e,t,-1)}},{key:"findNext",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(n=this.findAnyNext(e,[t],r))return n.pos}},{key:"findAnyNext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.editor.findAnyNext(e,t,n)}},{key:"findMatchingPair",value:function(e,t,n){var r,i,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(o=e,i=0;r=this.findAnyNext(o,[n,t],s);)if(o=r.pos+(s>0?r.str.length:0),r.str===(s>0?n:t)){if(!(i>0))return r;i--}else i++;return null}},{key:"addBrakets",value:function(e){var t;return t=(e=new c.PosCollection(e)).wrap(this.brakets,this.brakets).map(function(e){return e.selectContent()}),this.editor.applyReplacements(t)}},{key:"promptClosingCmd",value:function(e){return null!=this.closingPromp&&this.closingPromp.stop(),this.closingPromp=f.ClosingPromp.newFor(this,e).begin()}},{key:"parseAll",value:function(){var t,n,r,i,o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.nested>100)throw"Infinite parsing Recursion";for(r=0;t=this.nextCmd(r);)if(r=t.getEndPos(),this.editor.setCursorPos(r),t.init(),!o||null==t.content||null!=t.getCmd()&&t.getOption("preventParseAll")||(n=new e(new a.TextParser(t.content),{parent:this}),t.content=n.parseAll()),null!=(i=t.execute())){if(null!=i.then)throw new Error("Async nested commands are not supported");r=null!=t.replaceEnd?t.replaceEnd:this.editor.getCursorPos().end}return this.getText()}},{key:"getText",value:function(){return this.editor.text()}},{key:"isRoot",value:function(){return null==this.parent&&(null==this.inInstance||null==this.inInstance.finder)}},{key:"getRoot",value:function(){return this.isRoot?this:null!=this.parent?this.parent.getRoot():null!=this.inInstance?this.inInstance.codewave.getRoot():void 0}},{key:"removeCarret",value:function(e){return h.StringHelper.removeCarret(e,this.carretChar)}},{key:"getCarretPos",value:function(e){return h.StringHelper.getCarretPos(e,this.carretChar)}},{key:"regMarker",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"g";return new RegExp(h.StringHelper.escapeRegExp(this.marker),e)}},{key:"removeMarkers",value:function(e){return e.replace(this.regMarker(),"")}}])&&r(t.prototype,n),d&&r(t,d),e}();return e.inited=!1,e}.call(void 0);n.Codewave=d},{"./ClosingPromp":2,"./Command":6,"./Context":7,"./Logger":11,"./PositionedCmdInstance":13,"./Process":14,"./TextParser":17,"./helpers/StringHelper":28,"./positioning/PosCollection":32}],6:[function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.BaseCommand=n.Command=void 0;var a,l=e("./Context"),u=e("./Storage"),c=e("./helpers/NamespaceHelper");a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e in t?t[e]:n};var h=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,e),this.name=t,this.data=n,this.cmds=[],this.detectors=[],this.executeFunct=this.resultFunct=this.resultStr=this.aliasOf=this.cls=null,this.aliased=null,this.fullName=this.name,this.depth=0;var o=[null,!1];this._parent=o[0],this._inited=o[1],this.setParent(r),this.defaults={},this.defaultOptions={nameToParam:null,checkCarret:!0,parse:!1,beforeExecute:null,alterResult:null,preventParseAll:!1,replaceBox:!1},this.options={},this.finalOptions=null}return s(e,[{key:"parent",value:function(){return this._parent}},{key:"setParent",value:function(e){if(this._parent!==e)return this._parent=e,this.fullName=null!=this._parent&&null!=this._parent.name?this._parent.fullName+":"+this.name:this.name,this.depth=null!=this._parent&&null!=this._parent.depth?this._parent.depth+1:0}},{key:"init",value:function(){return this._inited||(this._inited=!0,this.parseData(this.data)),this}},{key:"unregister",value:function(){return this._parent.removeCmd(this)}},{key:"isEditable",value:function(){return null!=this.resultStr||null!=this.aliasOf}},{key:"isExecutable",value:function(){var e,t,n,r;if(null!=(e=this.getAliased()))return e.init().isExecutable();for(t=0,n=(r=["resultStr","resultFunct","cls","executeFunct"]).length;t<n;t++)if(null!=this[r[t]])return!0;return!1}},{key:"isExecutableWithName",value:function(e){var t,n,r;return null!=this.aliasOf?(r=new l.Context,t=this.aliasOf.replace("%name%",e),null!=(n=this._aliasedFromFinder(r.getFinder(t)))&&n.init().isExecutable()):this.isExecutable()}},{key:"resultIsAvailable",value:function(){var e,t,n,r;if(null!=(e=this.getAliased()))return e.resultIsAvailable();for(t=0,n=(r=["resultStr","resultFunct"]).length;t<n;t++)if(null!=this[r[t]])return!0;return!1}},{key:"getDefaults",value:function(){var e,t;return t={},null!=(e=this.getAliased())&&(t=Object.assign(t,e.getDefaults())),t=Object.assign(t,this.defaults)}},{key:"_aliasedFromFinder",value:function(e){return e.useFallbacks=!1,e.mustExecute=!1,e.useDetectors=!1,e.find()}},{key:"getAliased",value:function(){var e;if(null!=this.aliasOf)return e=new l.Context,this._aliasedFromFinder(e.getFinder(this.aliasOf))}},{key:"setOptions",value:function(e){var t,n,r;for(t in n=[],e)r=e[t],t in this.defaultOptions?n.push(this.options[t]=r):n.push(void 0);return n}},{key:"_optionsForAliased",value:function(e){var t;return t={},t=Object.assign(t,this.defaultOptions),null!=e&&(t=Object.assign(t,e.getOptions())),Object.assign(t,this.options)}},{key:"getOptions",value:function(){return this._optionsForAliased(this.getAliased())}},{key:"getOption",value:function(e){var t;if(e in(t=this.getOptions()))return t[e]}},{key:"help",value:function(){var e;if(null!=(e=this.getCmd("help")))return e.init().resultStr}},{key:"parseData",value:function(e){return this.data=e,"string"==typeof e?(this.resultStr=e,this.options.parse=!0,!0):null!=e&&this.parseDictData(e)}},{key:"parseDictData",value:function(t){var n,r;return"function"==typeof(r=a("result",t))?this.resultFunct=r:null!=r&&(this.resultStr=r,this.options.parse=!0),"function"==typeof(n=a("execute",t))&&(this.executeFunct=n),this.aliasOf=a("aliasOf",t),this.cls=a("cls",t),this.defaults=a("defaults",t,this.defaults),this.setOptions(t),"help"in t&&this.addCmd(new e("help",t.help,this)),"fallback"in t&&this.addCmd(new e("fallback",t.fallback,this)),"cmds"in t&&this.addCmds(t.cmds),!0}},{key:"addCmds",value:function(t){var n,r,i;for(r in i=[],t)n=t[r],i.push(this.addCmd(new e(r,n,this)));return i}},{key:"addCmd",value:function(e){var t;return null!=(t=this.getCmd(e.name))&&this.removeCmd(t),e.setParent(this),this.cmds.push(e),e}},{key:"removeCmd",value:function(e){var t;return(t=this.cmds.indexOf(e))>-1&&this.cmds.splice(t,1),e}},{key:"getCmd",value:function(e){var t,n,i,o,s,a,l;this.init();var u=r(c.NamespaceHelper.splitFirst(e),2);if(l=u[0],o=u[1],null!=l)return null!=(s=this.getCmd(l))?s.getCmd(o):void 0;for(n=0,i=(a=this.cmds).length;n<i;n++)if((t=a[n]).name===o)return t}},{key:"setCmdData",value:function(t,n){return this.setCmd(t,new e(t.split(":").pop(),n))}},{key:"setCmd",value:function(t,n){var i,o,s,a=r(c.NamespaceHelper.splitFirst(t),2);return s=a[0],i=a[1],null!=s?(null==(o=this.getCmd(s))&&(o=this.addCmd(new e(s))),o.setCmd(i,n)):(this.addCmd(n),n)}},{key:"addDetector",value:function(e){return this.detectors.push(e)}}],[{key:"initCmds",value:function(){var t,n,r,i,o;for(e.cmds=new e(null,{cmds:{hello:{help:'"Hello, world!" is typically one of the simplest programs possible in\nmost programming languages, it is by tradition often (...) used to\nverify that a language or system is operating correctly -wikipedia',result:"Hello, World!"}}}),o=[],t=0,n=(i=this.providers).length;t<n;t++)r=i[t],o.push(r.register(e.cmds));return o}},{key:"saveCmd",value:function(t,n){var r=this;return Promise.resolve().then(function(){return e.cmds.setCmdData(t,n)}).then(function(){return r.storage.saveInPath("cmds",t,n)})}},{key:"loadCmds",value:function(){var t=this;return Promise.resolve().then(function(){return t.storage.load("cmds")}).then(function(t){var n,r,i;if(null!=t){for(r in i=[],t)n=t[r],i.push(e.cmds.setCmdData(r,n));return i}})}},{key:"resetSaved",value:function(){return this.storage.save("cmds",{})}},{key:"makeVarCmd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.execute=function(t){var n,r;if(null!=(r=null!=(n=t.getParam(0))?n:t.content?t.content:void 0))return t.codewave.vars[e]=r},t}},{key:"makeBoolVarCmd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.execute=function(t){var n,r;if(null==(r=null!=(n=t.getParam(0))?n:t.content?t.content:void 0)||"0"!==r&&"false"!==r&&"no"!==r)return t.codewave.vars[e]=!0},t}}]),e}();return e.providers=[],e.storage=new u.Storage,e}.call(void 0);n.Command=h;var f=function(){function e(t){i(this,e),this.instance=t}return s(e,[{key:"init",value:function(){}},{key:"resultIsAvailable",value:function(){return null!=this.result}},{key:"getDefaults",value:function(){return{}}},{key:"getOptions",value:function(){return{}}}]),e}();n.BaseCommand=f},{"./Context":7,"./Storage":15,"./helpers/NamespaceHelper":26}],7:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Context=void 0;var i=e("./CmdFinder"),o=e("./CmdInstance"),s=e("./helpers/ArrayHelper"),a=[].indexOf,l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.codewave=t,this.nameSpaces=[]}var t,n,l;return t=e,(n=[{key:"addNameSpace",value:function(e){if(a.call(this.nameSpaces,e)<0)return this.nameSpaces.push(e),this._namespaces=null}},{key:"addNamespaces",value:function(e){var t,n,r,i;if(e){for("string"==typeof e&&(e=[e]),r=[],t=0,n=e.length;t<n;t++)i=e[t],r.push(this.addNameSpace(i));return r}}},{key:"removeNameSpace",value:function(e){return this.nameSpaces=this.nameSpaces.filter(function(t){return t!==e})}},{key:"getNameSpaces",value:function(){var e;return null==this._namespaces&&(e=["core"].concat(this.nameSpaces),null!=this.parent&&(e=e.concat(this.parent.getNameSpaces())),this._namespaces=s.ArrayHelper.unique(e)),this._namespaces}},{key:"getCmd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.getFinder(e,t).find()}},{key:"getFinder",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new i.CmdFinder(e,{namespaces:t,useDetectors:this.isRoot(),codewave:this.codewave,parentContext:this})}},{key:"isRoot",value:function(){return null==this.parent}},{key:"wrapComment",value:function(e){var t;return(t=this.getCommentChar()).indexOf("%s")>-1?t.replace("%s",e):t+" "+e+" "+t}},{key:"wrapCommentLeft",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(t=(e=this.getCommentChar()).indexOf("%s"))>-1?e.substr(0,t)+n:e+" "+n}},{key:"wrapCommentRight",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(t=(e=this.getCommentChar()).indexOf("%s"))>-1?n+e.substr(t+2):n+" "+e}},{key:"cmdInstanceFor",value:function(e){return new o.CmdInstance(e,this)}},{key:"getCommentChar",value:function(){var e,t,n,r;return null!=this.commentChar?this.commentChar:(e="\x3c!-- %s --\x3e",null!=(t=this.getCmd("comment"))&&((n=this.cmdInstanceFor(t)).content="%s",null!=(r=n.result())&&(e=r)),this.commentChar=e,this.commentChar)}}])&&r(t.prototype,n),l&&r(t,l),e}();n.Context=l},{"./CmdFinder":3,"./CmdInstance":4,"./helpers/ArrayHelper":24}],8:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.PairDetector=n.LangDetector=n.Detector=void 0;var h=e("./positioning/Pair"),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.data=t}return c(e,[{key:"detect",value:function(e){if(this.detected(e)){if(null!=this.data.result)return this.data.result}else if(null!=this.data.else)return this.data.else}},{key:"detected",value:function(e){}}]),e}();n.Detector=f;var d=function(e){function t(){return l(this,t),i(this,o(t).apply(this,arguments))}return s(t,f),c(t,[{key:"detect",value:function(e){var t;if(null!=e.codewave&&null!=(t=e.codewave.editor.getLang()))return t.toLowerCase()}}]),t}();n.LangDetector=d;var p=function(e){function t(){return l(this,t),i(this,o(t).apply(this,arguments))}return s(t,f),c(t,[{key:"detected",value:function(e){return!(null==this.data.opener||null==this.data.closer||null==e.instance||!new h.Pair(this.data.opener,this.data.closer,this.data).isWapperOf(e.instance.getPos(),e.codewave.editor.text()))}}]),t}();n.PairDetector=p},{"./positioning/Pair":29}],9:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.EditCmdProp=void 0;var f=e("./Command"),d=function(){function e(t,n){var r,i,o,s,a,l;for(u(this,e),this.name=t,r={var:null,opt:null,funct:null,dataName:null,showEmpty:!1,carret:!1},i=0,s=(a=["var","opt","funct"]).length;i<s;i++)(o=a[i])in n&&(r.dataName=n[o]);for(o in r)l=r[o],this[o]=o in n?n[o]:l}return h(e,[{key:"setCmd",value:function(e){return e[this.name]=f.Command.makeVarCmd(this.name)}},{key:"writeFor",value:function(e,t){if(null!=e.vars[this.name])return t[this.dataName]=e.vars[this.name]}},{key:"valFromCmd",value:function(e){if(null!=e){if(null!=this.opt)return e.getOption(this.opt);if(null!=this.funct)return e[this.funct]();if(null!=this.var)return e[this.var]}}},{key:"showForCmd",value:function(e){var t;return t=this.valFromCmd(e),this.showEmpty||null!=t}},{key:"display",value:function(e){if(this.showForCmd(e))return"~~".concat(this.name,"~~\n").concat(this.valFromCmd(e)||"").concat(this.carret?"|":"","\n~~/").concat(this.name,"~~")}}]),e}();n.EditCmdProp=d,d.source=function(e){function t(){return u(this,t),i(this,s(t).apply(this,arguments))}return a(t,d),h(t,[{key:"valFromCmd",value:function(e){var n;return null!=(n=o(s(t.prototype),"valFromCmd",this).call(this,e))&&(n=n.replace(/\|/g,"||")),n}},{key:"setCmd",value:function(e){return e[this.name]=f.Command.makeVarCmd(this.name,{preventParseAll:!0})}},{key:"showForCmd",value:function(e){var t;return t=this.valFromCmd(e),this.showEmpty&&!(null!=e&&null!=e.aliasOf)||null!=t}}]),t}(),d.string=function(e){function t(){return u(this,t),i(this,s(t).apply(this,arguments))}return a(t,d),h(t,[{key:"display",value:function(e){if(null!=this.valFromCmd(e))return"~~!".concat(this.name," '").concat(this.valFromCmd(e)).concat(this.carret?"|":"","'~~")}}]),t}(),d.revBool=function(e){function t(){return u(this,t),i(this,s(t).apply(this,arguments))}return a(t,d),h(t,[{key:"setCmd",value:function(e){return e[this.name]=f.Command.makeBoolVarCmd(this.name)}},{key:"writeFor",value:function(e,t){if(null!=e.vars[this.name])return t[this.dataName]=!e.vars[this.name]}},{key:"display",value:function(e){var t;if(null!=(t=this.valFromCmd(e))&&!t)return"~~!".concat(this.name,"~~")}}]),t}(),d.bool=function(e){function t(){return u(this,t),i(this,s(t).apply(this,arguments))}return a(t,d),h(t,[{key:"setCmd",value:function(e){return e[this.name]=f.Command.makeBoolVarCmd(this.name)}},{key:"display",value:function(e){if(this.valFromCmd(e))return"~~!".concat(this.name,"~~")}}]),t}()},{"./Command":6}],10:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Editor=void 0;var i=e("./positioning/Pos"),o=e("./positioning/StrPos"),s=e("./helpers/OptionalPromise"),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.namespace=null,this._lang=null}var t,n,a;return t=e,(n=[{key:"bindedTo",value:function(e){}},{key:"text",value:function(e){throw"Not Implemented"}},{key:"textCharAt",value:function(e){throw"Not Implemented"}},{key:"textLen",value:function(){throw"Not Implemented"}},{key:"textSubstr",value:function(e,t){throw"Not Implemented"}},{key:"insertTextAt",value:function(e,t){throw"Not Implemented"}},{key:"spliceText",value:function(e,t,n){throw"Not Implemented"}},{key:"getCursorPos",value:function(){throw"Not Implemented"}},{key:"setCursorPos",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];throw"Not Implemented"}},{key:"beginUndoAction",value:function(){}},{key:"endUndoAction",value:function(){}},{key:"getLang",value:function(){return this._lang}},{key:"setLang",value:function(e){return this._lang=e}},{key:"getEmmetContextObject",value:function(){return null}},{key:"allowMultiSelection",value:function(){return!1}},{key:"setMultiSel",value:function(e){throw"Not Implemented"}},{key:"getMultiSel",value:function(){throw"Not Implemented"}},{key:"canListenToChange",value:function(){return!1}},{key:"addChangeListener",value:function(e){throw"Not Implemented"}},{key:"removeChangeListener",value:function(e){throw"Not Implemented"}},{key:"getLineAt",value:function(e){return new i.Pos(this.findLineStart(e),this.findLineEnd(e))}},{key:"findLineStart",value:function(e){var t;return(t=this.findAnyNext(e,["\n"],-1))?t.pos+1:0}},{key:"findLineEnd",value:function(e){var t;return(t=this.findAnyNext(e,["\n","\r"]))?t.pos:this.textLen()}},{key:"findAnyNext",value:function(e,t){var n,r,i,s,a,l,u,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;for(u=c>0?this.textSubstr(e,this.textLen()):this.textSubstr(0,e),n=null,i=0,s=t.length;i<s;i++)l=t[i],-1!==(a=c>0?u.indexOf(l):u.lastIndexOf(l))&&(null==n||n*c>a*c)&&(n=a,r=l);return null!=r?new o.StrPos(c>0?n+e:n,r):null}},{key:"applyReplacements",value:function(e){var t=this;return e.reduce(function(e,n){return e.then(function(e){return n.withEditor(t),n.applyOffset(e.offset),(0,s.optionalPromise)(n.apply()).then(function(){return{selections:e.selections.concat(n.selections),offset:e.offset+n.offsetAfter(t)}})})},(0,s.optionalPromise)({selections:[],offset:0})).then(function(e){return t.applyReplacementsSelections(e.selections)}).result()}},{key:"applyReplacementsSelections",value:function(e){if(e.length>0)return this.allowMultiSelection()?this.setMultiSel(e):this.setCursorPos(e[0].start,e[0].end)}}])&&r(t.prototype,n),a&&r(t,a),e}();n.Editor=a},{"./helpers/OptionalPromise":27,"./positioning/Pos":31,"./positioning/StrPos":35}],11:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Logger=void 0;var i=function(){var e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"log",value:function(){var e,t,n,r;if(this.isEnabled()){r=[];for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];for(e=0,t=o.length;e<t;e++)n=o[e],r.push(console.log(n));return r}}},{key:"isEnabled",value:function(){return null!=("undefined"!=typeof console&&null!==console?console.log:void 0)&&this.enabled&&e.enabled}},{key:"runtime",value:function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"function";return n=performance.now(),t=e(),r=performance.now(),console.log("".concat(i," took ").concat(r-n," milliseconds.")),t}},{key:"toMonitor",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return n=e[t],e[t]=function(){var i;return i=arguments,this.monitor(function(){return n.apply(e,i)},r+t)}}},{key:"monitor",value:function(e,t){var n,r,i;return r=performance.now(),n=e(),i=performance.now(),null!=this.monitorData[t]?(this.monitorData[t].count++,this.monitorData[t].total+=i-r):this.monitorData[t]={count:1,total:i-r},n}},{key:"resume",value:function(){return console.log(this.monitorData)}}])&&r(t.prototype,n),i&&r(t,i),e}();return e.enabled=!0,e.prototype.enabled=!0,e.prototype.monitorData={},e}.call(void 0);n.Logger=i},{}],12:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.OptionObject=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"setOpts",value:function(e,t){var n,r,i,o;for(n in this.defaults=t,i=[],r=this.defaults)o=r[n],n in e?i.push(this.setOpt(n,e[n])):i.push(this.setOpt(n,o));return i}},{key:"setOpt",value:function(e,t){var n;return null!=(null!=(n=this[e])?n.call:void 0)?this[e](t):this[e]=t}},{key:"getOpt",value:function(e){var t;return null!=(null!=(t=this[e])?t.call:void 0)?this[e]():this[e]}},{key:"getOpts",value:function(){var e,t,n;for(e in t={},n=this.defaults)n[e],t[e]=this.getOpt(e);return t}}])&&r(t.prototype,n),i&&r(t,i),e}();n.OptionObject=i},{}],13:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.PositionedCmdInstance=void 0;var c=e("./CmdInstance"),h=e("./BoxHelper"),f=e("./positioning/Pos"),d=e("./positioning/StrPos"),p=e("./positioning/Replacement"),m=e("./helpers/StringHelper"),v=e("./helpers/NamespaceHelper"),y=e("./Command"),g=[].indexOf,b=function(e){function t(e,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=s(this,l(t).call(this))).codewave=e,i.pos=n,i.str=r,i.isEmpty()||(i._checkCloser(),i.opening=i.str,i.noBracket=i._removeBracket(i.str),i._splitComponents(),i._findClosing(),i._checkElongated()),i}var n,r,b;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,c.CmdInstance),n=t,(r=[{key:"_checkCloser",value:function(){var e;if(this._removeBracket(this.str).substring(0,this.codewave.closeChar.length)===this.codewave.closeChar&&(e=this._findOpeningPos()))return this.closingPos=new d.StrPos(this.pos,this.str),this.pos=e.pos,this.str=e.str}},{key:"_findOpeningPos",value:function(){var e,t,n,r;if(t=this._removeBracket(this.str).substring(this.codewave.closeChar.length),r=this.codewave.brakets+t,e=this.str,n=this.codewave.findMatchingPair(this.pos,r,e,-1))return n.str=this.codewave.editor.textSubstr(n.pos,this.codewave.findNextBraket(n.pos+n.str.length)+this.codewave.brakets.length),n}},{key:"_splitComponents",value:function(){var e;return e=this.noBracket.split(" "),this.cmdName=e.shift(),this.rawParams=e.join(" ")}},{key:"_parseParams",value:function(e){var t,n,r,i,o,s,a,l,u;if(this.params=[],this.named=this.getDefaults(),null!=this.cmd&&null!=(a=this.getOption("nameToParam"))&&(this.named[a]=this.cmdName),e.length){for(null!=this.cmd&&(t=this.getOption("allowedNamed")),i=!1,l="",s=!1,r=o=0,u=e.length-1;0<=u?o<=u:o>=u;r=0<=u?++o:--o)" "!==(n=e[r])||i?'"'!==n&&"'"!==n||0!==r&&"\\"===e[r-1]?":"!==n||s||i||!(null==t||g.call(t,s)>=0)?l+=n:(s=l,l=""):i=!i:(s?this.named[s]=l:this.params.push(l),l="",s=!1);if(l.length)return s?this.named[s]=l:this.params.push(l)}}},{key:"_findClosing",value:function(){var e;if(e=this._findClosingPos())return this.content=m.StringHelper.trimEmptyLine(this.codewave.editor.textSubstr(this.pos+this.str.length,e.pos)),this.str=this.codewave.editor.textSubstr(this.pos,e.pos+e.str.length)}},{key:"_findClosingPos",value:function(){var e,t,n;return null!=this.closingPos?this.closingPos:(e=this.codewave.brakets+this.codewave.closeChar+this.cmdName+this.codewave.brakets,n=this.codewave.brakets+this.cmdName,(t=this.codewave.findMatchingPair(this.pos+this.str.length,n,e))?this.closingPos=t:void 0)}},{key:"_checkElongated",value:function(){var e,t,n;for(e=this.getEndPos(),t=this.codewave.editor.textLen();e<t&&this.codewave.editor.textSubstr(e,e+this.codewave.deco.length)===this.codewave.deco;)e+=this.codewave.deco.length;if(e>=t||" "===(n=this.codewave.editor.textSubstr(e,e+this.codewave.deco.length))||"\n"===n||"\r"===n)return this.str=this.codewave.editor.textSubstr(this.pos,e)}},{key:"_checkBox",value:function(){var e,t,n;if(null==this.codewave.inInstance||"comment"!==this.codewave.inInstance.cmd.name)return e=this.context.wrapCommentLeft(),t=this.context.wrapCommentRight(),n=this.getEndPos()+t.length,this.codewave.editor.textSubstr(this.pos-e.length,this.pos)===e&&this.codewave.editor.textSubstr(n-t.length,n)===t?(this.pos=this.pos-e.length,this.str=this.codewave.editor.textSubstr(this.pos,n),this._removeCommentFromContent()):this.getPos().sameLinesPrefix().indexOf(e)>-1&&this.getPos().sameLinesSuffix().indexOf(t)>-1?(this.inBox=1,this._removeCommentFromContent()):void 0}},{key:"_removeCommentFromContent",value:function(){var e,t,n,r,i,o;if(this.content)return e=m.StringHelper.escapeRegExp(this.context.wrapCommentLeft()),t=m.StringHelper.escapeRegExp(this.context.wrapCommentRight()),n=m.StringHelper.escapeRegExp(this.codewave.deco),r=new RegExp("^\\s*".concat(e,"(?:").concat(n,")+\\s*(.*?)\\s*(?:").concat(n,")+").concat(t,"$"),"gm"),i=new RegExp("^\\s*(?:".concat(n,")*").concat(t,"\r?\n")),o=new RegExp("\n\\s*".concat(e,"(?:").concat(n,")*\\s*$")),this.content=this.content.replace(r,"$1").replace(i,"").replace(o,"")}},{key:"_getParentCmds",value:function(){var e;return this.parent=null!=(e=this.codewave.getEnclosingCmd(this.getEndPos()))?e.init():void 0}},{key:"setMultiPos",value:function(e){return this.multiPos=e}},{key:"_getCmdObj",value:function(){return this.getCmd(),this._checkBox(),this.content=this.removeIndentFromContent(this.content),a(l(t.prototype),"_getCmdObj",this).call(this)}},{key:"_initParams",value:function(){return this._parseParams(this.rawParams)}},{key:"getContext",value:function(){return this.context||this.codewave.context}},{key:"getCmd",value:function(){return null==this.cmd&&(this._getParentCmds(),this.noBracket.substring(0,this.codewave.noExecuteChar.length)===this.codewave.noExecuteChar?(this.cmd=y.Command.cmds.getCmd("core:no_execute"),this.context=this.codewave.context):(this.finder=this.getFinder(this.cmdName),this.context=this.finder.context,this.cmd=this.finder.find(),null!=this.cmd&&this.context.addNameSpace(this.cmd.fullName))),this.cmd}},{key:"getFinder",value:function(e){var t;return(t=this.codewave.context.getFinder(e,this._getParentNamespaces())).instance=this,t}},{key:"_getParentNamespaces",value:function(){var e,t;for(e=[],t=this;null!=t.parent;)null!=(t=t.parent).cmd&&null!=t.cmd.fullName&&e.push(t.cmd.fullName);return e}},{key:"_removeBracket",value:function(e){return e.substring(this.codewave.brakets.length,e.length-this.codewave.brakets.length)}},{key:"alterAliasOf",value:function(e){var t,n=i(v.NamespaceHelper.split(this.cmdName),2);return n[0],t=n[1],e.replace("%name%",t)}},{key:"isEmpty",value:function(){return this.str===this.codewave.brakets+this.codewave.closeChar+this.codewave.brakets||this.str===this.codewave.brakets+this.codewave.brakets}},{key:"execute",value:function(){var e,t;if(this.isEmpty())return null!=this.codewave.closingPromp&&null!=this.codewave.closingPromp.whithinOpenBounds(this.pos+this.codewave.brakets.length)?this.codewave.closingPromp.cancel():this.replaceWith("");if(null!=this.cmd){if((e=this.getOption("beforeExecute"))&&e(this),!this.resultIsAvailable())return this.runExecuteFunct();if(null!=(t=this.result()))return this.replaceWith(t)}}},{key:"getEndPos",value:function(){return this.pos+this.str.length}},{key:"getPos",value:function(){return new f.Pos(this.pos,this.pos+this.str.length).withEditor(this.codewave.editor)}},{key:"getOpeningPos",value:function(){return new f.Pos(this.pos,this.pos+this.opening.length).withEditor(this.codewave.editor)}},{key:"getIndent",value:function(){var e;return null==this.indentLen&&(null!=this.inBox?(e=new h.BoxHelper(this.context),this.indentLen=e.removeComment(this.getPos().sameLinesPrefix()).length):this.indentLen=this.pos-this.getPos().prevEOL()),this.indentLen}},{key:"removeIndentFromContent",value:function(e){var t;return null!=e?(t=new RegExp("^\\s{"+this.getIndent()+"}","gm"),e.replace(t,"")):e}},{key:"alterResultForBox",value:function(e){var t,n,r;if(r=e.copy(),(n=new h.BoxHelper(this.context)).getOptFromLine(r.textWithFullLines(),!1),this.getOption("replaceBox")){var o=[(t=n.getBoxForPos(r)).start,t.end];e.start=o[0],e.end=o[1],this.indentLen=n.indent,e.text=this.applyIndent(e.text)}else{e.text=this.applyIndent(e.text),e.start=r.prevEOL(),e.end=r.nextEOL();var s=i(n.reformatLines(r.sameLinesPrefix()+this.codewave.marker+e.text+this.codewave.marker+r.sameLinesSuffix(),{multiline:!1}).split(this.codewave.marker),3);e.prefix=s[0],e.text=s[1],e.suffix=s[2]}return e}},{key:"getCursorFromResult",value:function(e){var t,n;return t=e.resPosBeforePrefix(),null!=this.cmd&&this.codewave.checkCarret&&this.getOption("checkCarret")&&(null!=(n=this.codewave.getCarretPos(e.text))&&(t=e.start+e.prefix.length+n),e.text=this.codewave.removeCarret(e.text)),t}},{key:"checkMulti",value:function(e){var t,n,r,i,o,s,a,l,u;if(null!=this.multiPos&&this.multiPos.length>1){for(u=[e],s=e.originalText(),t=n=0,r=(l=this.multiPos).length;n<r;t=++n)a=l[t],0===t?o=a.start:(i=e.copy().applyOffset(a.start-o)).originalText()===s&&u.push(i);return u}return[e]}},{key:"replaceWith",value:function(e){return this.applyReplacement(new p.Replacement(this.pos,this.getEndPos(),e))}},{key:"applyReplacement",value:function(e){var t,n;return e.withEditor(this.codewave.editor),null!=this.inBox?this.alterResultForBox(e):e.text=this.applyIndent(e.text),t=this.getCursorFromResult(e),e.selections=[new f.Pos(t,t)],n=this.checkMulti(e),this.replaceStart=e.start,this.replaceEnd=e.resEnd(),this.codewave.editor.applyReplacements(n)}}])&&o(n.prototype,r),b&&o(n,b),t}();n.PositionedCmdInstance=b},{"./BoxHelper":1,"./CmdInstance":4,"./Command":6,"./helpers/NamespaceHelper":26,"./helpers/StringHelper":28,"./positioning/Pos":31,"./positioning/Replacement":33,"./positioning/StrPos":35}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Process=void 0;n.Process=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}},{}],15:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Storage=void 0;var i=e("./Logger"),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.engine=t}var t,n,o;return t=e,(n=[{key:"save",value:function(e,t){if(this.engineAvailable())return this.engine.save(e,t)}},{key:"saveInPath",value:function(e,t,n){if(this.engineAvailable())return this.engine.saveInPath(e,t,n)}},{key:"load",value:function(e){if(null!=this.engine)return this.engine.load(e)}},{key:"engineAvailable",value:function(){return null!=this.engine||(this.logger=this.logger||new i.Logger,this.logger.log("No storage engine available"),!1)}}])&&r(t.prototype,n),o&&r(t,o),e}();n.Storage=o},{"./Logger":11}],16:[function(e,t,n){"use strict";function r(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.TextAreaEditor=n.DomKeyListener=void 0;var h,f=e("./TextParser"),d=e("./positioning/Pos"),p=function(){function e(){l(this,e)}return c(e,[{key:"startListening",value:function(e){var t,n,r,i,o=this;return i=null,t=function(e){if((Codewave.instances.length<2||o.obj===document.activeElement)&&69===e.keyCode&&e.ctrlKey&&(e.preventDefault(),null!=o.onActivationKey))return o.onActivationKey()},r=function(e){if(null!=o.onAnyChange)return o.onAnyChange(e)},n=function(e){return null!=i&&clearTimeout(i),i=setTimeout(function(){if(null!=o.onAnyChange)return o.onAnyChange(e)},100)},e.addEventListener?(e.addEventListener("keydown",t),e.addEventListener("keyup",r),e.addEventListener("keypress",n)):e.attachEvent?(e.attachEvent("onkeydown",t),e.attachEvent("onkeyup",r),e.attachEvent("onkeypress",n)):void 0}}]),e}();n.DomKeyListener=p,h=function(e){try{return e instanceof HTMLElement}catch(t){return t,"object"===a(e)&&1===e.nodeType&&"object"===a(e.style)&&"object"===a(e.ownerDocument)}};var m=function(){var e=function(e){function t(e){var n;if(l(this,t),(n=r(this,o(t).call(this))).target=e,n.obj=h(n.target)?n.target:document.getElementById(n.target),null==n.obj)throw"TextArea not found";return n.namespace="textarea",n.changeListeners=[],n._skipChangeEvent=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,f.TextParser),c(t,[{key:"onAnyChange",value:function(e){var t,n,r,i,o;if(this._skipChangeEvent<=0){for(o=[],n=0,r=(i=this.changeListeners).length;n<r;n++)t=i[n],o.push(t());return o}if(this._skipChangeEvent--,null!=this.onSkipedChange)return this.onSkipedChange()}},{key:"skipChangeEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this._skipChangeEvent+=e}},{key:"bindedTo",value:function(e){return this.onActivationKey=function(){return e.onActivationKey()},this.startListening(document)}},{key:"selectionPropExists",value:function(){return"selectionStart"in this.obj}},{key:"hasFocus",value:function(){return document.activeElement===this.obj}},{key:"text",value:function(e){return null!=e&&(this.textEventChange(e)||(this.obj.value=e)),this.obj.value}},{key:"spliceText",value:function(e,n,r){return this.textEventChange(r,e,n)||this.spliceTextWithExecCommand(r,e,n)||i(o(t.prototype),"spliceText",this).call(this,e,n,r)}},{key:"textEventChange",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!=document.createEvent&&(t=document.createEvent("TextEvent")),null!=t&&null!=t.initTextEvent&&!1!==t.isTrusted){if(null==r&&(r=this.textLen()),e.length<1)if(0!==n)e=this.textSubstr(n-1,n),n--;else{if(r===this.textLen())return!1;e=this.textSubstr(r,r+1),r++}return t.initTextEvent("textInput",!0,!0,null,e,9),this.obj.selectionStart=n,this.obj.selectionEnd=r,this.obj.dispatchEvent(t),this.skipChangeEvent(),!0}return!1}},{key:"spliceTextWithExecCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=document.execCommand&&(null==n&&(n=this.textLen()),this.obj.selectionStart=t,this.obj.selectionEnd=n,document.execCommand("insertText",!1,e))}},{key:"getCursorPos",value:function(){return null!=this.tmpCursorPos?this.tmpCursorPos:this.hasFocus?this.selectionPropExists?new d.Pos(this.obj.selectionStart,this.obj.selectionEnd):this.getCursorPosFallback():void 0}},{key:"getCursorPosFallback",value:function(){var e,t,n,r;if(this.obj.createTextRange&&(r=document.selection.createRange()).parentElement()===this.obj){for((n=this.obj.createTextRange()).moveToBookmark(r.getBookmark()),e=0;n.compareEndPoints("EndToStart",n)>0;)e++,n.moveEnd("character",-1);for(n.setEndPoint("StartToStart",this.obj.createTextRange()),t=new d.Pos(0,e);n.compareEndPoints("EndToStart",n)>0;)t.start++,t.end++,n.moveEnd("character",-1);return t}}},{key:"setCursorPos",value:function(e,t){var n=this;arguments.length<2&&(t=e),this.selectionPropExists?(this.tmpCursorPos=new d.Pos(e,t),this.obj.selectionStart=e,this.obj.selectionEnd=t,setTimeout(function(){return n.tmpCursorPos=null,n.obj.selectionStart=e,n.obj.selectionEnd=t},1)):this.setCursorPosFallback(e,t)}},{key:"setCursorPosFallback",value:function(e,t){var n;if(this.obj.createTextRange)return(n=this.obj.createTextRange()).moveStart("character",e),n.collapse(),n.moveEnd("character",t-e),n.select()}},{key:"getLang",value:function(){return this._lang?this._lang:this.obj.hasAttribute("data-lang")?this.obj.getAttribute("data-lang"):void 0}},{key:"setLang",value:function(e){return this._lang=e,this.obj.setAttribute("data-lang",e)}},{key:"canListenToChange",value:function(){return!0}},{key:"addChangeListener",value:function(e){return this.changeListeners.push(e)}},{key:"removeChangeListener",value:function(e){var t;if((t=this.changeListeners.indexOf(e))>-1)return this.changeListeners.splice(t,1)}},{key:"applyReplacements",value:function(e){return e.length>0&&e[0].selections.length<1&&(e[0].selections=[this.getCursorPos()]),i(o(t.prototype),"applyReplacements",this).call(this,e)}}]),t}();return e.prototype.startListening=p.prototype.startListening,e}.call(void 0);n.TextAreaEditor=m},{"./TextParser":17,"./positioning/Pos":31}],17:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.TextParser=void 0;var l=e("./Editor"),u=e("./positioning/Pos"),c=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=o(this,s(t).call(this)))._text=e,n}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,l.Editor),n=t,(r=[{key:"text",value:function(e){return null!=e&&(this._text=e),this._text}},{key:"textCharAt",value:function(e){return this.text()[e]}},{key:"textLen",value:function(e){return this.text().length}},{key:"textSubstr",value:function(e,t){return this.text().substring(e,t)}},{key:"insertTextAt",value:function(e,t){return this.text(this.text().substring(0,t)+e+this.text().substring(t,this.text().length))}},{key:"spliceText",value:function(e,t,n){return this.text(this.text().slice(0,e)+(n||"")+this.text().slice(t))}},{key:"getCursorPos",value:function(){return this.target}},{key:"setCursorPos",value:function(e,t){return arguments.length<2&&(t=e),this.target=new u.Pos(e,t)}}])&&i(n.prototype,r),c&&i(n,c),t}();n.TextParser=c},{"./Editor":10,"./positioning/Pos":31}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Codewave",{enumerable:!0,get:function(){return r.Codewave}});var r=e("./Codewave"),i=e("./Command"),o=e("./cmds/CoreCommandProvider"),s=e("./cmds/JsCommandProvider"),a=e("./cmds/PhpCommandProvider"),l=e("./cmds/HtmlCommandProvider"),u=e("./positioning/Pos"),c=e("./positioning/WrappedPos"),h=e("./storageEngines/LocalStorageEngine");u.Pos.wrapClass=c.WrappedPos,r.Codewave.instances=[],i.Command.providers=[new o.CoreCommandProvider,new s.JsCommandProvider,new a.PhpCommandProvider,new l.HtmlCommandProvider],"undefined"!=typeof localStorage&&null!==localStorage&&(i.Command.storage=new h.LocalStorageEngine)},{"./Codewave":5,"./Command":6,"./cmds/CoreCommandProvider":19,"./cmds/HtmlCommandProvider":20,"./cmds/JsCommandProvider":21,"./cmds/PhpCommandProvider":22,"./positioning/Pos":31,"./positioning/WrappedPos":36,"./storageEngines/LocalStorageEngine":38}],19:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.CoreCommandProvider=void 0;var h,f,d,p,m,v,y,g,b,w,k,x,C,P=e("../Command"),_=e("../Detector"),O=e("../BoxHelper"),S=e("../EditCmdProp"),E=e("../helpers/StringHelper"),j=e("../positioning/Replacement"),T=function(){function e(){l(this,e)}return c(e,[{key:"register",value:function(e){var t;return(t=e.addCmd(new P.Command("core"))).addDetector(new _.LangDetector),t.addCmds({help:{replaceBox:!0,result:'~~box~~\n~~quote_carret~~\n  ___         _   __      __\n / __|___  __| |__\\ \\    / /_ ___ ______\n/ /__/ _ \\/ _` / -_\\ \\/\\/ / _` \\ V / -_/\n\\____\\___/\\__,_\\___|\\_/\\_/\\__,_|\\_/\\___|\nThe text editor helper\n~~/quote_carret~~\n\nWhen using Codewave you will be writing commands within \nyour text editor. These commands must be placed between two \npairs of "~" (tilde) and then, they can be executed by pressing \n"ctrl"+"shift"+"e", with your cursor inside the command\nEx: ~~!hello~~\n\nYou dont need to actually type any "~" (tilde). \nPressing "ctrl"+"shift"+"e" will add them if you are not already\nwithin a command.\n\nCodewave does not use UI to display any information. \nInstead, it uses text within code comments to mimic UIs. \nThe generated comment blocks will be referred to as windows \nin the help sections.\n\nTo close this window (i.e. remove this comment block), press \n"ctrl"+"shift"+"e" with your cursor on the line bellow.\n~~!close|~~\n\nUse the following command for a walkthrough of some of the many\nfeatures of Codewave\n~~!help:get_started~~ or ~~!help:demo~~\n\nList of all help subjects \n~~!help:subjects~~ or ~~!help:sub~~ \n\n~~!close~~\n~~/box~~',cmds:{subjects:{replaceBox:!0,result:"~~box~~\n~~!help~~\n~~!help:get_started~~ (~~!help:demo~~)\n~~!help:subjects~~ (~~!help:sub~~)\n~~!help:editing~~ (~~!help:edit~~)\n~~!close|~~\n~~/box~~"},sub:{aliasOf:"help:subjects"},get_started:{replaceBox:!0,result:'~~box~~\nThe classic Hello World.\n~~!hello|~~\n\n~~help:editing:intro~~\n~~quote_carret~~\n\nFor more information on creating your own commands, see:\n~~!help:editing~~\n\nCodewave comes with many pre-existing commands. Here is an example\nof JavaScript abbreviations\n~~!js:f~~\n~~!js:if~~\n  ~~!js:log~~"~~!hello~~"~~!/js:log~~\n~~!/js:if~~\n~~!/js:f~~\n\nCodeWave comes with the excellent Emmet ( http://emmet.io/ ) to \nprovide event more abbreviations. Emmet abbreviations will be \nused automatically if you are in a HTML or CSS file.\n~~!ul>li~~ (if you are in a html doccument)\n~~!emmet ul>li~~\n~~!emmet m2 css~~\n\nCommands are stored in namespaces. The same command can have \ndifferent results depending on the namespace.\n~~!js:each~~\n~~!php:outer:each~~\n~~!php:inner:each~~\n\nSome of the namespaces are active depending on the context. The\nfollowing commands are the same and will display the currently\nactive namespace. The first command command works because the \ncore namespace is active.\n~~!namespace~~\n~~!core:namespace~~\n\nYou can make a namespace active with the following command.\n~~!namespace php~~\n\nCheck the namespaces again\n~~!namespace~~\n\nIn addition to detecting the document type, Codewave can detect the\ncontext from the surrounding text. In a PHP file, it means Codewave \nwill add the PHP tags when you need them.\n\n~~/quote_carret~~\n~~!close|~~\n~~/box~~'},demo:{aliasOf:"help:get_started"},editing:{cmds:{intro:{result:'Codewave allows you to make your own commands (or abbreviations) \nput your content inside "source" the do "save". Try adding any \ntext that is on your mind.\n~~!edit my_new_command|~~\n\nIf you did the last step right, you should see your text when you\ndo the following command. It is now saved and you can use it \nwhenever you want.\n~~!my_new_command~~'}},replaceBox:!0,result:'~~box~~\n~~help:editing:intro~~\n\nAll the windows of Codewave are made with the command "box". \nThey are meant to display text that should not remain in your code. \nThey are valid comments so they won\'t break your code and the command \n"close" can be used to remove them rapidly. You can make your own \ncommands with them if you need to display some text temporarily.\n~~!box~~\nThe box will scale with the content you put in it\n~~!close|~~\n~~!/box~~\n\n~~quote_carret~~\nWhen you create a command, you may want to specify where the cursor \nwill be located once the command is expanded. To do that, use a "|" \n(Vertical bar). Use 2 of them if you want to print the actual \ncharacter.\n~~!box~~\none : | \ntwo : ||\n~~!/box~~\n\nYou can also use the "escape_pipes" command that will escape any \nvertical bars that are between its opening and closing tags\n~~!escape_pipes~~\n|\n~~!/escape_pipes~~\n\nCommands inside other commands will be expanded automatically.\nIf you want to print a command without having it expand when \nthe parent command is expanded, use a "!" (exclamation mark).\n~~!!hello~~\n\nFor commands that have both an opening and a closing tag, you can use\nthe "content" command. "content" will be replaced with the text\nthat is between the tags. Here is an example of how it can be used.\n~~!edit php:inner:if~~\n\n~~/quote_carret~~\n~~!close|~~\n~~/box~~'},edit:{aliasOf:"help:editing"}}},no_execute:{result:w},escape_pipes:{result:k,checkCarret:!1},quote_carret:{aliasOf:"core:escape_pipes"},exec_parent:{execute:y},content:{result:g},box:{cls:h},close:{cls:f},param:{result:b},edit:{cmds:d.setCmds({save:{aliasOf:"core:exec_parent"}}),cls:d},rename:{cmds:{not_applicable:"~~box~~\nYou can only rename commands that you created yourself.\n~~!close|~~\n~~/box~~",not_found:"~~box~~\nCommand not found\n~~!close|~~\n~~/box~~"},result:C,parse:!0},remove:{cmds:{not_applicable:"~~box~~\nYou can only remove commands that you created yourself.\n~~!close|~~\n~~/box~~",not_found:"~~box~~\nCommand not found\n~~!close|~~\n~~/box~~"},result:x,parse:!0},alias:{cmds:{not_found:"~~box~~\nCommand not found\n~~!close|~~\n~~/box~~"},result:v,parse:!0},namespace:{cls:m},nspc:{aliasOf:"core:namespace"},emmet:{cls:p}})}}]),e}();n.CoreCommandProvider=T,w=function(e){var t;return t=new RegExp("^("+E.StringHelper.escapeRegExp(e.codewave.brakets)+")"+E.StringHelper.escapeRegExp(e.codewave.noExecuteChar)),e.str.replace(t,"$1")},k=function(e){return e.content.replace(/\|/g,"||")},y=function(e){var t;if(null!=e.parent)return t=e.parent.execute(),e.replaceStart=e.parent.replaceStart,e.replaceEnd=e.parent.replaceEnd,t},g=function(e){var t,n,r;return t=e.getParam(["affixes_empty"],!1),n=e.getParam(["prefix"],""),r=e.getParam(["suffix"],""),null!=e.codewave.inInstance?n+(e.codewave.inInstance.content||"")+r:t?n+r:void 0},C=function(e){return Promise.resolve().then(function(){return P.Command.storage.load("cmds")}).then(function(t){var n,r,i,o;if(o=e.getParam([0,"from"]),i=e.getParam([1,"to"]),null!=o&&null!=i)return n=e.context.getCmd(o),null!=t[o]&&null!=n?(i.indexOf(":")>-1||(i=n.fullName.replace(o,"")+i),r=t[o],P.Command.cmds.setCmdData(i,r),n.unregister(),t[i]=r,delete t[o],Promise.resolve().then(function(){return storage.save("cmds",t)}).then(function(){return""})):null!=n?"~~not_applicable~~":"~~not_found~~"})},x=function(e){return Promise.resolve().then(function(){var t;if(null!=(t=e.getParam([0,"name"])))return Promise.resolve().then(function(){return P.Command.storage.load("cmds")}).then(function(n){var r;return r=e.context.getCmd(t),null!=n[t]&&null!=r?(n[t],r.unregister(),delete n[t],Promise.resolve().then(function(){return storage.save("cmds",n)}).then(function(){return""})):null!=r?"~~not_applicable~~":"~~not_found~~"})})},v=function(e){var t,n,r;if(r=e.getParam([0,"name"]),t=e.getParam([1,"alias"]),null!=r&&null!=t)return null!=(n=e.context.getCmd(r))?(n=n.getAliased()||n,P.Command.saveCmd(t,{aliasOf:n.fullName}),""):"~~not_found~~"},b=function(e){if(null!=e.codewave.inInstance)return e.codewave.inInstance.getParam(e.params,e.getParam(["def","default"]))},h=function(e){function t(){return l(this,t),i(this,o(t).apply(this,arguments))}return s(t,P.BaseCommand),c(t,[{key:"init",value:function(){return this.helper=new O.BoxHelper(this.instance.context),this.cmd=this.instance.getParam(["cmd"]),null!=this.cmd&&(this.helper.openText=this.instance.codewave.brakets+this.cmd+this.instance.codewave.brakets,this.helper.closeText=this.instance.codewave.brakets+this.instance.codewave.closeChar+this.cmd.split(" ")[0]+this.instance.codewave.brakets),this.helper.deco=this.instance.codewave.deco,this.helper.pad=2,this.helper.prefix=this.instance.getParam(["prefix"],""),this.helper.suffix=this.instance.getParam(["suffix"],"")}},{key:"height",value:function(){var e,t;return e=null!=this.bounds()?this.bounds().height:3,t=["height"],this.instance.params.length>1?t.push(1):this.instance.params.length>0&&t.push(0),this.instance.getParam(t,e)}},{key:"width",value:function(){var e,t;return t=null!=this.bounds()?this.bounds().width:3,e=["width"],this.instance.params.length>1&&e.push(0),Math.max(this.minWidth(),this.instance.getParam(e,t))}},{key:"bounds",value:function(){if(this.instance.content)return null==this._bounds&&(this._bounds=this.helper.textBounds(this.instance.content)),this._bounds}},{key:"result",value:function(){return this.helper.height=this.height(),this.helper.width=this.width(),this.helper.draw(this.instance.content)}},{key:"minWidth",value:function(){return null!=this.cmd?this.cmd.length:0}}]),t}(),f=function(e){function t(){return l(this,t),i(this,o(t).apply(this,arguments))}return s(t,P.BaseCommand),c(t,[{key:"init",value:function(){return this.helper=new O.BoxHelper(this.instance.context)}},{key:"execute",value:function(){var e,t,n,r;return n=this.helper.prefix=this.instance.getParam(["prefix"],""),r=this.helper.suffix=this.instance.getParam(["suffix"],""),e=this.helper.getBoxForPos(this.instance.getPos()),this.instance.getParam(["required_affixes"],!0)||(this.helper.prefix=this.helper.suffix="",null!=(t=this.helper.getBoxForPos(this.instance.getPos()))&&(null==e||e.start<t.start-n.length||e.end>t.end+r.length)&&(e=t)),null!=e?(this.helper.getNestedLvl(this.instance.getPos().start)<2&&(this.instance.inBox=null),this.instance.applyReplacement(new j.Replacement(e.start,e.end,""))):this.instance.replaceWith("")}}]),t}(),(d=function(e){function t(){return l(this,t),i(this,o(t).apply(this,arguments))}return s(t,P.BaseCommand),c(t,[{key:"init",value:function(){var e;return this.cmdName=this.instance.getParam([0,"cmd"]),this.verbalize="v"===(e=this.instance.getParam([1]))||"verbalize"===e,null!=this.cmdName&&(this.finder=this.instance.context.getFinder(this.cmdName),this.finder.useFallbacks=!1,this.cmd=this.finder.find()),this.editable=null==this.cmd||this.cmd.isEditable()}},{key:"getOptions",value:function(){return{allowedNamed:["cmd"]}}},{key:"result",value:function(){return this.instance.content?this.resultWithContent():this.resultWithoutContent()}},{key:"resultWithContent",value:function(){var e,n,r,i,o;for((i=this.instance.getParserForText(this.instance.content)).parseAll(),e={},n=0,r=(o=t.props).length;n<r;n++)o[n].writeFor(i,e);return P.Command.saveCmd(this.cmdName,e),""}},{key:"propsDisplay",value:function(){var e;return e=this.cmd,t.props.map(function(t){return t.display(e)}).filter(function(e){return null!=e}).join("\n")}},{key:"resultWithoutContent",value:function(){var e,t;if(!this.cmd||this.editable)return e=this.cmd?this.cmd.fullName:this.cmdName,(t=this.instance.getParserForText('~~box cmd:"'.concat(this.instance.cmd.fullName," ").concat(e,'"~~\n').concat(this.propsDisplay(),"\n~~!save~~ ~~!close~~\n~~/box~~"))).checkCarret=!1,this.verbalize?t.getText():t.parseAll()}}]),t}()).setCmds=function(e){var t,n,r;for(t=0,n=(r=d.props).length;t<n;t++)r[t].setCmd(e);return e},d.props=[new S.EditCmdProp.revBool("no_carret",{opt:"checkCarret"}),new S.EditCmdProp.revBool("no_parse",{opt:"parse"}),new S.EditCmdProp.bool("prevent_parse_all",{opt:"preventParseAll"}),new S.EditCmdProp.bool("replace_box",{opt:"replaceBox"}),new S.EditCmdProp.string("name_to_param",{opt:"nameToParam"}),new S.EditCmdProp.string("alias_of",{var:"aliasOf",carret:!0}),new S.EditCmdProp.source("help",{funct:"help",showEmpty:!0}),new S.EditCmdProp.source("source",{var:"resultStr",dataName:"result",showEmpty:!0,carret:!0})],m=function(e){function t(){return l(this,t),i(this,o(t).apply(this,arguments))}return s(t,P.BaseCommand),c(t,[{key:"init",value:function(){return this.name=this.instance.getParam([0])}},{key:"result",value:function(){var e,t,n,r,i;if(null!=this.name)return this.instance.codewave.getRoot().context.addNameSpace(this.name),"";for(i="~~box~~\n",e=0,t=(n=this.instance.context.getNameSpaces()).length;e<t;e++)(r=n[e])!==this.instance.cmd.fullName&&(i+=r+"\n");return i+="~~!close|~~\n~~/box~~",this.instance.getParserForText(i).parseAll()}}]),t}(),p=function(t){function n(){return l(this,n),i(this,o(n).apply(this,arguments))}return s(n,P.BaseCommand),c(n,[{key:"init",value:function(){return this.abbr=this.instance.getParam([0,"abbr","abbreviation"]),this.lang=this.instance.getParam([1,"lang","language"])}},{key:"result",value:function(){var t;if(null!=(t=function(){var t,n;if(null!=("undefined"!=typeof window&&null!==window?window.emmet:void 0))return window.emmet;if(null!=("undefined"!=typeof window&&null!==window&&null!=(t=window.self)?t.emmet:void 0))return window.self.emmet;if(null!=("undefined"!=typeof window&&null!==window&&null!=(n=window.global)?n.emmet:void 0))return window.global.emmet;if(null!=e)try{return e("emmet")}catch(e){return e,this.instance.codewave.logger.log("Emmet is not available, it may need to be installed manually"),null}}.call(this)))return t.expandAbbreviation(this.abbr,this.lang).replace(/\$\{0\}/g,"|")}}]),n}()},{"../BoxHelper":1,"../Command":6,"../Detector":8,"../EditCmdProp":9,"../helpers/StringHelper":28,"../positioning/Replacement":33,emmet:"emmet"}],20:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.HtmlCommandProvider=void 0;var i=e("../Command"),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"register",value:function(e){return e.addCmd(new i.Command("html")).addCmds({fallback:{aliasOf:"core:emmet",defaults:{lang:"html"},nameToParam:"abbr"}}),e.addCmd(new i.Command("css")).addCmds({fallback:{aliasOf:"core:emmet",defaults:{lang:"css"},nameToParam:"abbr"}})}}])&&r(t.prototype,n),o&&r(t,o),e}();n.HtmlCommandProvider=o},{"../Command":6}],21:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.JsCommandProvider=void 0;var i=e("../Command"),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"register",value:function(e){var t;return t=e.addCmd(new i.Command("js")),e.addCmd(new i.Command("javascript",{aliasOf:"js"})),t.addCmds({comment:"/* ~~content~~ */",if:"if(|){\n\t~~content~~\n}",log:"if(window.console){\n\tconsole.log(~~content~~|)\n}",function:"function |() {\n\t~~content~~\n}",funct:{aliasOf:"js:function"},f:{aliasOf:"js:function"},for:"for (var i = 0; i < |; i++) {\n\t~~content~~\n}",forin:"for (var val in |) {\n\t~~content~~\n}",each:{aliasOf:"js:forin"},foreach:{aliasOf:"js:forin"},while:"while(|) {\n\t~~content~~\n}",whilei:"var i = 0;\nwhile(|) {\n\t~~content~~\n\ti++;\n}",ifelse:"if( | ) {\n\t~~content~~\n} else {\n\t\n}",ife:{aliasOf:"js:ifelse"},switch:"switch( | ) { \n\tcase :\n\t\t~~content~~\n\t\tbreak;\n\tdefault :\n\t\t\n\t\tbreak;\n}"})}}])&&r(t.prototype,n),o&&r(t,o),e}();n.JsCommandProvider=o},{"../Command":6}],22:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.PhpCommandProvider=void 0;var i,o=e("../helpers/StringHelper"),s=e("../Command"),a=e("../Detector"),l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"register",value:function(e){var t;return(t=e.addCmd(new s.Command("php"))).addDetector(new a.PairDetector({result:"php:inner",opener:"<?php",closer:"?>",optionnal_end:!0,else:"php:outer"})),t.addCmd(new s.Command("outer")).addCmds({fallback:{cmds:{any_content:{aliasOf:"core:content",defaults:{prefix:" ?>\n",suffix:"\n<?php ",affixes_empty:!0}}},aliasOf:"php:inner:%name%",alterResult:i},box:{aliasOf:"core:box",defaults:{prefix:"<?php\n",suffix:"\n?>"}},comment:"/* ~~content~~ */",php:"<?php\n\t~~content~~|\n?>"}),t.addCmd(new s.Command("inner")).addCmds({any_content:{aliasOf:"core:content"},comment:"/* ~~content~~ */",if:"if(|){\n\t~~any_content~~\n}",info:"phpinfo();",echo:"echo |",e:{aliasOf:"php:inner:echo"},class:{result:"class ~~param 0 class def:|~~ {\n\tfunction __construct() {\n\t\t~~content~~|\n\t}\n}",defaults:{inline:!1}},c:{aliasOf:"php:inner:class"},function:{result:"function |() {\n\t~~content~~\n}",defaults:{inline:!1}},funct:{aliasOf:"php:inner:function"},f:{aliasOf:"php:inner:function"},array:"$| = array();",a:"array()",for:"for ($i = 0; $i < $|; $i++) {\n\t~~any_content~~\n}",foreach:"foreach ($| as $key => $val) {\n\t~~any_content~~\n}",each:{aliasOf:"php:inner:foreach"},while:"while(|) {\n\t~~any_content~~\n}",whilei:{result:"$i = 0;\nwhile(|) {\n\t~~any_content~~\n\t$i++;\n}",defaults:{inline:!1}},ifelse:"if( | ) {\n\t~~any_content~~\n} else {\n\t\n}",ife:{aliasOf:"php:inner:ifelse"},switch:{result:"switch( | ) { \n\tcase :\n\t\t~~any_content~~\n\t\tbreak;\n\tdefault :\n\t\t\n\t\tbreak;\n}",defaults:{inline:!1}},close:{aliasOf:"core:close",defaults:{prefix:"<?php\n",suffix:"\n?>",required_affixes:!1}}})}}])&&r(t.prototype,n),o&&r(t,o),e}();n.PhpCommandProvider=l,i=function(e,t){var n,r;return t.getParam(["php_inline","inline"],!0)?(r=/<\?php\s([\\n\\r\s]+)/g,n=/([\n\r\s]+)\s\?>/g,"<?php "+e.replace(r,"$1<?php ").replace(n," ?>$1")+" ?>"):"<?php\n"+o.StringHelper.indent(e)+"\n?>"}},{"../Command":6,"../Detector":8,"../helpers/StringHelper":28}],23:[function(e,t,n){"use strict";var r=e("./bootstrap"),i=e("./TextAreaEditor");r.Codewave.detect=function(e){var t;return t=new r.Codewave(new i.TextAreaEditor(e)),r.Codewave.instances.push(t),t},r.Codewave.require=e,window.Codewave=r.Codewave},{"./TextAreaEditor":16,"./bootstrap":18}],24:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.ArrayHelper=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"isArray",value:function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{key:"union",value:function(e,t){return this.unique(e.concat(t))}},{key:"unique",value:function(e){var t,n,r;for(t=e.concat(),n=0;n<t.length;){for(r=n+1;r<t.length;)t[n]===t[r]&&t.splice(r--,1),++r;++n}return t}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();n.ArrayHelper=i},{}],25:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.CommonHelper=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"merge",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if((null!=t?t.length:void 0)>0)return this.tap({},function(e){var n,r,i,o,s,a;for(o=[],n=0,i=t.length;n<i;n++)a=t[n],o.push(function(){var t;for(r in t=[],a)s=a[r],t.push(e[r]=s);return t}());return o})}},{key:"tap",value:function(e,t){return t(e),e}},{key:"applyMixins",value:function(e,t){return t.forEach(function(t){return Object.getOwnPropertyNames(t.prototype).forEach(function(n){return Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t.prototype,n))})})}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();n.CommonHelper=i},{}],26:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.NamespaceHelper=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"splitFirst",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return-1!==e.indexOf(":")||n?[(t=e.split(":")).shift(),t.join(":")||null]:[null,e]}},{key:"split",value:function(e){var t,n;return-1===e.indexOf(":")?[null,e]:(t=(n=e.split(":")).pop(),[n.join(":"),t])}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();n.NamespaceHelper=i},{}],27:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.optionalPromise=n.OptionalPromise=void 0;var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.val=t,null!=this.val&&null!=this.val.then&&null!=this.val.result&&(this.val=this.val.result())}var t,n,i;return t=e,(n=[{key:"then",value:function(t){return null!=this.val&&null!=this.val.then?new e(this.val.then(t)):new e(t(this.val))}},{key:"result",value:function(){return this.val}}])&&r(t.prototype,n),i&&r(t,i),e}();n.OptionalPromise=i;n.optionalPromise=function(e){return new i(e)}},{}],28:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.StringHelper=void 0;var i=e("../positioning/Size"),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"trimEmptyLine",value:function(e){return e.replace(/^\s*\r?\n/,"").replace(/\r?\n\s*$/,"")}},{key:"escapeRegExp",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"repeatToLength",value:function(e,t){return t<=0?"":Array(Math.ceil(t/e.length)+1).join(e).substring(0,t)}},{key:"repeat",value:function(e,t){return Array(t+1).join(e)}},{key:"getTxtSize",value:function(e){var t,n,r,o,s;for(s=0,t=0,r=(o=e.replace(/\r/g,"").split("\n")).length;t<r;t++)n=o[t],s=Math.max(s,n.length);return new i.Size(s,o.length-1)}},{key:"indentNotFirst",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"  ";return null!=e?(t=/\n/g,e.replace(t,"\n"+this.repeat(r,n))):e}},{key:"indent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"  ";return null!=e?n+this.indentNotFirst(e,t,n):e}},{key:"reverseStr",value:function(e){return e.split("").reverse().join("")}},{key:"removeCarret",value:function(e){var t,n,r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"|";return i="[[[[quoted_carret]]]]",t=new RegExp(this.escapeRegExp(o),"g"),n=new RegExp(this.escapeRegExp(o+o),"g"),r=new RegExp(this.escapeRegExp(i),"g"),e.replace(n,i).replace(t,"").replace(r,o)}},{key:"getAndRemoveFirstCarret",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"|";if(null!=(t=this.getCarretPos(e,n)))return[t,e=e.substr(0,t)+e.substr(t+n.length)]}},{key:"getCarretPos",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"|";if(n=new RegExp(this.escapeRegExp(r+r),"g"),(t=(e=e.replace(n," ")).indexOf(r))>-1)return t}}],(n=null)&&r(t.prototype,n),o&&r(t,o),e}();n.StringHelper=o},{"../positioning/Size":34}],29:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Pair=void 0;var i=e("./Pos"),o=e("../helpers/StringHelper"),s=e("./PairMatch"),a=function(){function e(t,n){var r,i,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opener=t,this.closer=n,this.options=s,r={optionnal_end:!1,validMatch:null})o=r[i],i in this.options?this[i]=this.options[i]:this[i]=o}var t,n,a;return t=e,(n=[{key:"openerReg",value:function(){return"string"==typeof this.opener?new RegExp(o.StringHelper.escapeRegExp(this.opener)):this.opener}},{key:"closerReg",value:function(){return"string"==typeof this.closer?new RegExp(o.StringHelper.escapeRegExp(this.closer)):this.closer}},{key:"matchAnyParts",value:function(){return{opener:this.openerReg(),closer:this.closerReg()}}},{key:"matchAnyPartKeys",value:function(){var e,t,n;for(e in t=[],n=this.matchAnyParts())n[e],t.push(e);return t}},{key:"matchAnyReg",value:function(){var e,t,n,r;for(t in e=[],n=this.matchAnyParts())r=n[t],e.push("("+r.source+")");return new RegExp(e.join("|"))}},{key:"matchAny",value:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;null!=(t=this._matchAny(e,n))&&!t.valid();)n=t.end();if(null!=t&&t.valid())return t}},{key:"_matchAny",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n&&(e=e.substr(n)),null!=(t=this.matchAnyReg().exec(e)))return new s.PairMatch(this,t,n)}},{key:"matchAnyNamed",value:function(e){return this._matchAnyGetName(this.matchAny(e))}},{key:"matchAnyLast",value:function(e){for(var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=this.matchAny(e,r);)r=t.end(),n&&n.end()===t.end()||(n=t);return n}},{key:"identical",value:function(){return this.opener===this.closer||null!=this.opener.source&&null!=this.closer.source&&this.opener.source===this.closer.source}},{key:"wrapperPos",value:function(e,t){var n,r;if(null!=(r=this.matchAnyLast(t.substr(0,e.start)))&&(this.identical()||"opener"===r.name())){if(null!=(n=this.matchAny(t,e.end))&&(this.identical()||"closer"===n.name()))return new i.Pos(r.start(),n.end());if(this.optionnal_end)return new i.Pos(r.start(),t.length)}}},{key:"isWapperOf",value:function(e,t){return null!=this.wrapperPos(e,t)}}])&&r(t.prototype,n),a&&r(t,a),e}();n.Pair=a},{"../helpers/StringHelper":28,"./PairMatch":30,"./Pos":31}],30:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.PairMatch=void 0;var i=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pair=t,this.match=n,this.offset=r}var t,n,i;return t=e,(n=[{key:"name",value:function(){var e,t,n,r,i,o;if(this.match){if(null==e){for(n=r=0,i=(o=this.match).length;r<i;n=++r)if(t=o[n],n>0&&null!=t)return e=this.pair.matchAnyPartKeys()[n-1];e=!1}return e||null}}},{key:"start",value:function(){return this.match.index+this.offset}},{key:"end",value:function(){return this.match.index+this.match[0].length+this.offset}},{key:"valid",value:function(){return!this.pair.validMatch||this.pair.validMatch(this)}},{key:"length",value:function(){return this.match[0].length}}])&&r(t.prototype,n),i&&r(t,i),e}();n.PairMatch=i},{}],31:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.Pos=void 0;var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=t,this.end=n,null==this.end&&(this.end=this.start)}var t,n,i;return t=e,(n=[{key:"containsPt",value:function(e){return this.start<=e&&e<=this.end}},{key:"containsPos",value:function(e){return this.start<=e.start&&e.end<=this.end}},{key:"wrappedBy",value:function(t,n){return new e.wrapClass(this.start-t.length,this.start,this.end,this.end+n.length)}},{key:"withEditor",value:function(e){return this._editor=e,this}},{key:"editor",value:function(){if(null==this._editor)throw new Error("No editor set");return this._editor}},{key:"hasEditor",value:function(){return null!=this._editor}},{key:"text",value:function(){return this.editor().textSubstr(this.start,this.end)}},{key:"applyOffset",value:function(e){return 0!==e&&(this.start+=e,this.end+=e),this}},{key:"prevEOL",value:function(){return null==this._prevEOL&&(this._prevEOL=this.editor().findLineStart(this.start)),this._prevEOL}},{key:"nextEOL",value:function(){return null==this._nextEOL&&(this._nextEOL=this.editor().findLineEnd(this.end)),this._nextEOL}},{key:"textWithFullLines",value:function(){return null==this._textWithFullLines&&(this._textWithFullLines=this.editor().textSubstr(this.prevEOL(),this.nextEOL())),this._textWithFullLines}},{key:"sameLinesPrefix",value:function(){return null==this._sameLinesPrefix&&(this._sameLinesPrefix=this.editor().textSubstr(this.prevEOL(),this.start)),this._sameLinesPrefix}},{key:"sameLinesSuffix",value:function(){return null==this._sameLinesSuffix&&(this._sameLinesSuffix=this.editor().textSubstr(this.end,this.nextEOL())),this._sameLinesSuffix}},{key:"copy",value:function(){var t;return t=new e(this.start,this.end),this.hasEditor()&&t.withEditor(this.editor()),t}},{key:"raw",value:function(){return[this.start,this.end]}}])&&r(t.prototype,n),i&&r(t,i),e}();n.Pos=i},{}],32:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.PosCollection=void 0;var i=e("./Wrapping"),o=e("./Replacement"),s=e("../helpers/CommonHelper"),a=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Array.isArray(t)||(t=[t]),s.CommonHelper.applyMixins(t,[e]),t}var t,n,a;return t=e,(n=[{key:"wrap",value:function(e,t){return this.map(function(n){return new i.Wrapping(n.start,n.end,e,t)})}},{key:"replace",value:function(e){return this.map(function(t){return new o.Replacement(t.start,t.end,e)})}}])&&r(t.prototype,n),a&&r(t,a),e}();n.PosCollection=a},{"../helpers/CommonHelper":25,"./Replacement":33,"./Wrapping":37}],33:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.Replacement=void 0;var u=e("./Pos"),c=e("../helpers/CommonHelper"),h=e("../OptionObject"),f=e("../helpers/StringHelper"),d=function(){var e=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=s(this,a(t).call(this))).start=e,i.end=n,i.text=r,i.options=o,i.setOpts(i.options,{prefix:"",suffix:"",selections:[]}),i}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,u.Pos),n=t,(r=[{key:"resPosBeforePrefix",value:function(){return this.start+this.prefix.length+this.text.length}},{key:"resEnd",value:function(){return this.start+this.finalText().length}},{key:"apply",value:function(){return this.editor().spliceText(this.start,this.end,this.finalText())}},{key:"necessary",value:function(){return this.finalText()!==this.originalText()}},{key:"originalText",value:function(){return this.editor().textSubstr(this.start,this.end)}},{key:"finalText",value:function(){return this.prefix+this.text+this.suffix}},{key:"offsetAfter",value:function(){return this.finalText().length-(this.end-this.start)}},{key:"applyOffset",value:function(e){var t,n,r,i;if(0!==e)for(this.start+=e,this.end+=e,t=0,n=(r=this.selections).length;t<n;t++)(i=r[t]).start+=e,i.end+=e;return this}},{key:"selectContent",value:function(){return this.selections=[new u.Pos(this.prefix.length+this.start,this.prefix.length+this.start+this.text.length)],this}},{key:"carretToSel",value:function(){var e,t,n,r;for(this.selections=[],r=this.finalText(),this.prefix=f.StringHelper.removeCarret(this.prefix),this.text=f.StringHelper.removeCarret(this.text),this.suffix=f.StringHelper.removeCarret(this.suffix),n=this.start;null!=(t=f.StringHelper.getAndRemoveFirstCarret(r));){var o=i(t,2);e=o[0],r=o[1],this.selections.push(new u.Pos(n+e,n+e))}return this}},{key:"copy",value:function(){var e;return e=new t(this.start,this.end,this.text,this.getOpts()),this.hasEditor()&&e.withEditor(this.editor()),e.selections=this.selections.map(function(e){return e.copy()}),e}}])&&o(n.prototype,r),c&&o(n,c),t}();return c.CommonHelper.applyMixins(e.prototype,[h.OptionObject]),e}.call(void 0);n.Replacement=d},{"../OptionObject":12,"../helpers/CommonHelper":25,"../helpers/StringHelper":28,"./Pos":31}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Size=void 0;n.Size=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n}},{}],35:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.StrPos=void 0;var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=t,this.str=n}var t,n,i;return t=e,(n=[{key:"end",value:function(){return this.pos+this.str.length}}])&&r(t.prototype,n),i&&r(t,i),e}();n.StrPos=i},{}],36:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.WrappedPos=void 0;var l=e("./Pos"),u=function(e){function t(e,n,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=o(this,s(t).call(this))).start=e,a.innerStart=n,a.innerEnd=r,a.end=i,a}var n,r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,l.Pos),n=t,(r=[{key:"innerContainsPt",value:function(e){return this.innerStart<=e&&e<=this.innerEnd}},{key:"innerContainsPos",value:function(e){return this.innerStart<=e.start&&e.end<=this.innerEnd}},{key:"innerText",value:function(){return this.editor().textSubstr(this.innerStart,this.innerEnd)}},{key:"setInnerLen",value:function(e){return this.moveSufix(this.innerStart+e)}},{key:"moveSuffix",value:function(e){var t;return t=this.end-this.innerEnd,this.innerEnd=e,this.end=this.innerEnd+t}},{key:"copy",value:function(){return new t(this.start,this.innerStart,this.innerEnd,this.end)}}])&&i(n.prototype,r),u&&i(n,u),t}();n.WrappedPos=u},{"./Pos":31}],37:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(n,"__esModule",{value:!0}),n.Wrapping=void 0;var u=e("./Replacement"),c=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=o(this,a(t).call(this))).start=e,r.end=n,r.options=l,r.setOpts(r.options),r.text="",r.prefix=i,r.suffix=s,r}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,u.Replacement),n=t,(r=[{key:"apply",value:function(){return this.adjustSel(),s(a(t.prototype),"apply",this).call(this)}},{key:"adjustSel",value:function(){var e,t,n,r,i,o;for(n=this.originalText().length,i=[],e=0,t=(r=this.selections).length;e<t;e++)(o=r[e]).start>this.start+this.prefix.length&&(o.start+=n),o.end>=this.start+this.prefix.length?i.push(o.end+=n):i.push(void 0);return i}},{key:"finalText",value:function(){var e;return e=this.hasEditor()?this.originalText():"",this.prefix+e+this.suffix}},{key:"offsetAfter",value:function(){return this.prefix.length+this.suffix.length}},{key:"copy",value:function(){var e;return(e=new t(this.start,this.end,this.prefix,this.suffix)).selections=this.selections.map(function(e){return e.copy()}),e}}])&&i(n.prototype,r),c&&i(n,c),t}();n.Wrapping=c},{"./Replacement":33}],38:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.LocalStorageEngine=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"save",value:function(e,t){if("undefined"!=typeof localStorage&&null!==localStorage)return localStorage.setItem(this.fullKey(e),JSON.stringify(t))}},{key:"saveInPath",value:function(e,t,n){var r;return null==(r=this.load(e))&&(r={}),r[t]=n,this.save(e,r)}},{key:"load",value:function(e){if("undefined"!=typeof localStorage&&null!==localStorage)return JSON.parse(localStorage.getItem(this.fullKey(e)))}},{key:"fullKey",value:function(e){return"CodeWave_"+e}}])&&r(t.prototype,n),i&&r(t,i),e}();n.LocalStorageEngine=i},{}]},{},[23]);